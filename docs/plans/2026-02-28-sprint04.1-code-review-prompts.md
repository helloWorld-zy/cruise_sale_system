# Sprint 4.1 Code Review Prompts（邮轮介绍模块 + 舱位商品管理）

此文档包含 Sprint 4.1 的全量 Code Review Prompt。供 Antigravity 在审核代码时使用。本 Sprint 对已有基础代码进行增量扩展，涵盖 **7 个维度**的审计（含前端视觉设计审计）。

---

## 统一角色设定（每次 Review 必须前置声明）

**Role**: 你是一个极其严格的资深架构师（Senior Staff Engineer）、安全审计专家及资深 QA。你的目标是对代码进行最严苛的审查（Code Review）。

**核心准则**:
1. **测试驱动开发 (TDD)**: 必须先有失败测试（RED），再有实现代码（GREEN）。测试覆盖率必须达到 100%。发现漏测立刻指出。
2. **架构规范**: 后端必须遵循领域驱动设计 (DDD)、RESTful API 规范、依赖注入；前端必须采用 Vue 3 `<script setup lang="ts">` 及 Pinia 最佳实践。
3. **违规处理流程**: 如果发现任何违背项（如：缺乏测试、违背单一职责、潜在并发/安全漏洞），**绝对不允许直接通过**。请先生成详细的修改方案，当前 review 完成后整体修复发现的问题，完成后再次 review。
4. **增量修改合规性**: 本 Sprint 允许跨层修改已有文件。审查时必须确认：(a) 对已有接口签名的修改是否同步更新了所有调用方；(b) 新增字段是否在迁移文件中完整覆盖；(c) 修改不得破坏已有 Sprint 1-4 的测试。

---

## 维度一：领域模型扩展审计

**Context**: 本 Sprint 对 `Cruise`、`CabinType`、`Facility`、`FacilityCategory`、`CabinSKU`、`CabinInventory`、`CabinPrice`、`Image` 等核心领域模型进行大规模字段扩展，需确保模型完整性和向后兼容性。

**Strict Checklist**:
- [ ] **Cruise 模型完整性**: 逐一对照 Specify A.1，确认 `Cruise` struct 是否包含以下所有字段：`Code`（唯一索引）、`CrewCount`、`RefurbishYear`、`Length`、`Width`、`DeckCount`。`Status` 是否支持三种状态（0=下架, 1=上架, 2=维护中）？是否存在字段遗漏？
- [ ] **CabinType 模型完整性**: 逐一对照 Specify A.2，确认是否包含：`Code`、`AreaMin`/`AreaMax`（面积范围）、`MaxCapacity`（max vs standard 区分）、`BedType`（多种床型配置说明）、`Tags`（特色标签）、`Amenities`（设施清单）、`FloorPlanURL`（平面图）。富文本 `Description` 是否为 `type:text`？
- [ ] **Facility 模型完整性**: 逐一对照 Specify A.3，确认是否包含：`OpenHours`、`ExtraCharge`（bool）、`ChargePriceTip`（参考价格说明）、`TargetAudience`（适合人群标签）。
- [ ] **CabinSKU 属性完整性**: 逐一对照 Specify B 中的舱位属性要求，确认是否包含：`Position`（fore/mid/aft）、`Orientation`（port/starboard）、`HasWindow`、`HasBalcony`、`BedType`、`Amenities`。
- [ ] **Image 模型多态安全**: `Image.IsPrimary` 字段是否在同一 `entity_type + entity_id` 下保证唯一主图约束？如果有多张图片被标记为 `IsPrimary=true`，Service 层是否有校验逻辑防止数据不一致？
- [ ] **GORM Tag 规范**: 所有新增字段的 `gorm` tag 是否正确指定了 `size`/`type`/`index`/`default`？`json` tag 是否与前端共享类型一一对应？是否存在未标注 `json` tag 导致 API 响应字段名不一致的问题？
- [ ] **向后兼容**: 修改后的 struct 是否保留了旧字段（如 `CabinType.Area`）以兼容已有数据？是否有 `omitempty` 导致零值字段在 JSON 序列化时被意外吞掉？
- [ ] **软删除一致性**: 新增/修改的模型是否正确使用了 `DeletedAt *time.Time gorm:"index"` 实现软删除？所有查询是否自动排除了软删除记录？

**执行动作**：逐文件审计 `backend/internal/domain/` 下所有被修改的文件，每个字段逐一与 Specify 原文对照。只要有一条不符，输出红色的整改方案，并要求后续修复后重新 Review。

---

## 维度二：数据库迁移与 Schema 审计

**Context**: 本 Sprint 新增迁移文件 `000005_sprint41_extend.up.sql`，通过 `ALTER TABLE` 为多张已有表增加列，并新增索引。

**Strict Checklist**:
- [ ] **迁移文件完整性**: 逐一检查 `.up.sql` 中的 `ALTER TABLE` 语句，是否覆盖了 Task 1-4 和 Task 9-13 中所有新增的 struct 字段？严禁出现 Go struct 有字段但迁移无对应列的情况。
- [ ] **IF NOT EXISTS 防御**: 所有 `ALTER TABLE ADD COLUMN` 是否使用 `IF NOT EXISTS` 语法以防止重复执行迁移报错？
- [ ] **数据类型一致**: Go struct 中 `float64` 映射 PostgreSQL 是否为 `DOUBLE PRECISION` 而非 `REAL`（精度不足）？`bool` 是否映射为 `BOOLEAN`？`string gorm:"type:text"` 是否映射为 `TEXT` 而非 `VARCHAR`？
- [ ] **默认值安全**: 新增列的 `DEFAULT` 值是否合理？特别是 `Status` 列默认值是否与业务含义一致（如新增舱位默认应为下架/0 还是上架/1）？
- [ ] **索引优化**: 是否为高频查询字段建立了索引？特别是：`cruises.code`（唯一索引）、`cruises.status`、`cabin_types.code`、`images(entity_type, entity_id)` 的联合索引？是否存在冗余索引或缺失索引？
- [ ] **DOWN 迁移可逆性**: `.down.sql` 是否能完整回滚 `.up.sql` 的所有变更？`DROP COLUMN` 顺序是否正确（先删依赖列再删主列）？
- [ ] **外键约束**: 新增的关联字段（如 `FacilityCategory.Status`）是否需要外键约束？已有外键是否仍然有效未被破坏？
- [ ] **迁移测试**: 迁移测试是否验证了文件存在性？是否建议增加 SQL 语法校验（至少 parse `.up.sql` 确保无语法错误）？

**执行动作**：打开迁移文件和所有 domain struct 文件进行逐列对照审计。只要有一条不符，输出红色的整改方案。

---

## 维度三：Repository / Service / Handler 层架构审计

**Context**: 本 Sprint 扩展了多个仓储接口签名、新增了 `ImageRepository`、扩展了 Service 层（批量操作、库存预警）、扩展了 Handler 层（新路由和请求体结构）。

**Strict Checklist**:
- [ ] **接口签名同步**: `CruiseRepository.List` 签名变更后，所有调用方（`CruiseService`、`CruiseHandler`、所有 `_test.go` 中的 mock）是否全部同步更新？是否存在编译错误未发现的隐患（如 mock 中方法签名不匹配）？强烈建议运行 `go build ./...` 确认零编译错误。
- [ ] **仓储层 Context 传递**: 所有新增/修改的 Repository 方法是否严格使用 `db.WithContext(ctx)` ？是否存在直接使用 `r.db.Find()` 而未传递 Context 的危险用法（可能导致 Goroutine 泄漏或超时控制失效）？
- [ ] **批量操作 SQL 注入**: `BatchUpdateStatus(ctx, ids []int64, status)` 的实现中，`ids` 切片是否直接拼接到 SQL 字符串中？必须使用 GORM 的 `Where("id IN ?", ids)` 参数化查询，严禁字符串拼接。
- [ ] **ImageRepository 事务安全**: `SetImages` 逻辑（先 DeleteByEntity 再批量 Create）是否在同一个数据库事务中？如果不在事务中，中途失败会导致图片丢失且无法回滚。
- [ ] **CabinSKUFilter 零值陷阱**: 筛选条件 `CabinSKUFilter` 中 `Status int16` 的零值 `0` 恰好是"下架"状态。当用户不传 status 参数时，是否会错误地只返回下架舱位？必须使用指针 `*int16` 或单独的 `StatusSet bool` 标志来区分"未设置"和"值为 0"。
- [ ] **库存预警查询性能**: `CheckAlerts()` 是否全表扫描 `cabin_inventories`？当数据量大时是否会造成慢查询？是否应添加 `WHERE alert_threshold > 0` 前置过滤？
- [ ] **Handler 请求体校验**: 所有新增的 Request struct 是否正确使用了 `binding:"required"` tag 标注必填字段？是否存在数值字段（如 `Tonnage`、`Length`）接受负值的风险？是否需要 `binding:"min=0"` 约束？
- [ ] **Handler 错误响应统一**: 所有新增 Handler 方法的错误响应是否使用了 `response.Error()` 而非直接 `c.JSON()`？错误码是否使用了 `errcode` 包中定义的常量而非硬编码的 magic number？
- [ ] **Router 路由注册**: 新增路由（batch-status、images、alerts、facility update/get 等）是否全部注册在 `router.go` 中？是否受 JWT + RBAC 中间件保护？是否存在遗漏导致未鉴权即可访问的安全漏洞？
- [ ] **Swagger 注解同步**: 所有被修改签名或新增的 Handler 方法是否都有完整的 Swagger 注解（@Summary, @Tags, @Security, @Param, @Success, @Failure, @Router）？运行 `make swagger` 是否能无错误生成最新文档？

**执行动作**：从 `repository.go` 接口定义出发，追踪每个接口变更到 repo 实现 → service 调用 → handler 调用 → router 注册 → test mock 的完整链路。只要有一条断链或不符，输出红色的整改方案。

---

## 维度四：前端管理后台审计

**Context**: 本 Sprint 增强了 Admin 端的邮轮管理、舱房类型管理、设施管理和舱位商品管理页面。

**Strict Checklist**:
- [ ] **Vue 规范强制**: 所有新增/修改的 `.vue` 文件是否严格使用 `<script setup lang="ts">`？是否存在 Options API、普通 `<script>` 或缺少 `lang="ts"` 的违规？
- [ ] **API 实联验证 — 邮轮管理**: 邮轮列表页是否通过 API（`GET /api/v1/admin/cruises`）获取数据而非硬编码？筛选（关键词、状态）是否作为 query 参数传递给后端？批量上下架是否调用了 `PUT /api/v1/admin/cruises/batch-status`？
- [ ] **API 实联验证 — 舱房类型**: 舱房类型列表/新建/编辑页是否通过 API CRUD 与后端通信？表单是否包含 Specify A.2 要求的所有字段（代码、面积范围、容量、床型、标签多选、设施清单多选、富文本介绍、图片画廊、平面图）？
- [ ] **API 实联验证 — 设施管理**: 设施分类和设施的 CRUD 页面是否与后端 API 实联？设施编辑表单是否包含开放时间、额外收费、收费说明、适合人群标签等 Specify A.3 要求的全部字段？
- [ ] **API 实联验证 — 舱位商品**: 舱位列表页是否支持三级联动筛选（邮轮→航线→舱型）？批量操作是否调用后端 API？库存预警页 (`alerts.vue`) 是否调用 `GET /admin/cabins/alerts` 获取预警数据？价格日历是否支持多价格类型 Tab（base/child/single_supplement/holiday/early_bird）？
- [ ] **图片上传组件**: 图片上传是否调用了 `POST /admin/upload/image` 获取 URL，再通过 `POST /admin/images` 保存关联？是否实现了多图拖拽排序和主图设置功能？上传时是否限制了文件类型（仅 image/*）和文件大小（防止恶意大文件）？
- [ ] **富文本编辑器安全**: TipTap 编辑器输出的 HTML 内容在存储到后端和前台渲染时，是否有 XSS 过滤/sanitize？是否存在 `v-html` 直接渲染未过滤内容的风险？
- [ ] **状态处理三态**: 每个与 API 通信的页面是否都处理了 `loading`（加载中骨架屏/spinner）、`error`（错误提示/重试按钮）、`empty`（空数据占位图）三种状态？发现任何只有 happy path 无错误处理的页面立即标记为阻塞性问题。
- [ ] **表单校验**: 新建/编辑表单是否使用了 VeeValidate + Zod 或等效方案进行前端校验？必填字段是否有红色星号标注和空值提示？数值字段是否限制了范围（如吨位 > 0、面积 > 0）？
- [ ] **响应式布局**: 管理后台页面在 1280px 和 1920px 宽度下是否都能正常显示？表格列数较多时是否有水平滚动或列隐藏策略？

**执行动作**：逐页审计 Admin 端所有被修改/新增的 Vue 页面。打开每个页面的 `<script setup>` 部分，检查是否有真实的 API 调用和完整的状态处理。只要有一条不符，输出红色的整改方案。

---

## 维度五：前台展示（Web + 小程序）审计

**Context**: 本 Sprint 新增了 Web 和小程序前台的邮轮列表/详情页和舱位浏览增强。

**Strict Checklist**:
- [ ] **邮轮列表页（Web）**: 是否以卡片式布局展示？每张卡片是否展示封面图（主图来自 Image API）、名称、吨位、载客人数、舱房类型数量？是否支持搜索/筛选？是否调用了后端公开 API（非 admin API）？
- [ ] **邮轮详情页（Web）完整性**: 逐一对照 Specify A.4 检查：(a) 顶部轮播图画廊 (b) 基本参数区块（7 项参数） (c) 舱房类型折叠列表（主图+名称+面积+人数+起始价，可展开） (d) 设施导览 Tab 切换 (e) 设施详情弹窗 (f) 关联航线入口。缺少任何一项标记为阻塞性问题。
- [ ] **小程序适配**: 小程序页面是否使用了 `<view>`、`<text>`、`<image>`、`<swiper>` 等原生组件而非 HTML 标签？布局单位是否使用 `rpx`？是否使用了 `uni.request` 封装调用 API？
- [ ] **小程序邮轮详情**: 是否实现了与 Web 版邮轮详情相同的所有功能模块（轮播、参数、舱房列表、设施导览）？
- [ ] **舱位详情增强**: Web 和小程序的舱位详情页是否展示了扩展属性（位置/朝向/窗户/阳台标签、床型、设施清单）？价格日历是否展示多类型价格？库存状态标签（充足/紧张/即将售罄）的阈值逻辑是否合理且与后端 `CabinInventory` 一致？
- [ ] **C 端 API 路由安全**: 前台页面调用的 API 是否使用了 C 端公开路由（`/api/v1/cruises`、`/api/v1/cabins` 等）而非 Admin 路由？如果 C 端路由尚不存在，是否在 `router.go` 中正确注册了公开查询接口？
- [ ] **图片懒加载与性能**: 邮轮列表页的封面图和详情页的画廊图片是否实现了懒加载（`loading="lazy"` 或自定义指令）？轮播图是否设置了合理的图片尺寸以避免 CLS（Cumulative Layout Shift）？
- [ ] **SEO（仅 Web）**: 邮轮列表页和详情页是否设置了正确的 `<title>`、`<meta description>`、语义化的 `<h1>` 标签？是否利用了 Nuxt 4 的 SSR 能力进行首屏直出？

**执行动作**：逐页审计 Web 和小程序的所有新增页面，逐项与 Specify A.4 和 B 对照。只要有一条不符，输出红色的整改方案。

---

## 维度六：测试质量 + 覆盖率终审

**Context**: 本 Sprint 涉及大量文件的修改和新增，必须确保所有代码路径都有覆盖且测试质量达标。

**Strict Checklist**:
- [ ] **后端覆盖率 100%**: 运行 `cd backend && go test ./... -coverprofile=coverage -count=1` 后，使用 `go tool cover -func=coverage` 检查每个包的覆盖率是否为 100%。任何低于 100% 的包必须列出未覆盖的行号并要求补测。
- [ ] **前端覆盖率 100%**: 分别运行 Admin (`pnpm vitest run --coverage`)、Web、Miniapp 的测试套件，确认所有分支覆盖率均为 100%。
- [ ] **测试质量审计 — 后端**: 逐一检查所有 `_test.go` 文件，确认：
  - 每个测试是否包含有意义的业务断言（验证返回值/状态码/错误信息），而非仅 `if err != nil`？
  - Mock 对象是否完整实现了接口的所有方法（包括扩展后的新方法）？是否存在方法签名不匹配导致隐式编译错误？
  - 是否覆盖了边界条件：批量操作空切片、筛选零值陷阱、库存预警阈值为 0 时的行为、图片列表为空时的处理？
  - 是否存在 `//nolint` 或 `_ = err` 吞掉错误的危险用法？全文搜索确认。
- [ ] **测试质量审计 — 前端**: 逐一检查所有 `.spec.ts` 文件，确认：
  - 每条测试是否包含有意义的业务断言（验证 API 调用参数、响应数据渲染、错误处理路径），而非仅断言组件可渲染或 `true === true`？
  - 是否存在 `istanbul ignore` / `/* c8 ignore */` 跳过未测代码？全文搜索确认。
  - 是否存在空函数体替代真实逻辑、仅 import 不调用、删除/注释失败测试等"伪覆盖"手段？
  - 是否覆盖了用户交互路径：筛选操作、批量选择、分页切换、图片上传/排序/删除、表单校验失败？
- [ ] **回归测试**: Sprint 1-4 的所有已有测试是否仍然全部通过？运行完整测试套件确认零失败。任何因本 Sprint 修改导致的已有测试失败都是阻塞性问题。
- [ ] **接口签名变更追踪**: 本 Sprint 修改了 `CruiseRepository.List` 等关键接口签名。全文搜索旧签名确认已无残留调用。检查所有 mock 和 fake 实现是否已同步更新。

**执行动作**：
1. 运行后端全量测试并检查覆盖率报告，列出所有未达 100% 的包。
2. 运行三个前端项目的测试并检查覆盖率报告。
3. 全文搜索 `//nolint`、`istanbul ignore`、`c8 ignore`、`_ = err` 等标记。
4. 逐文件审计测试质量。
只要有一条不符，输出红色的整改方案，并要求后续修复后重新 Review。

---

## 维度七：前端视觉设计审计

**Context**: 本 Sprint 要求 Admin、Web、Miniapp 三端采用差异化视觉设计语言。Admin 为专业数据驱动型（Slate/Indigo），Web 为沉浸式旅行杂志风格（深海蓝 + 暖金 + Playfair Display），Miniapp 为原生微信设计语言（珊瑚橘 + 清远青）。同时 Web 和小程序展示的业务数据内容必须完全一致。

**Strict Checklist**:

### Admin 视觉合规
- [ ] **色彩体系**: 主色是否严格使用 `Indigo-600` (#4F46E5)？背景是否为 `Slate-50` 页面底 + `White` 卡片底？状态标签颜色是否按规范区分（Emerald 上架 / Amber 维护 / Rose 下架）？是否存在随意使用鲜艳颜色（如 `red-600`, `blue-500`）的 ad-hoc 用色？
- [ ] **排版字体**: 是否通过 Google Fonts 引入了 `Inter`（英文）和 `Noto Sans SC`（中文）？是否在 `nuxt.config` 或全局 CSS 中配置？是否存在使用浏览器默认 Arial/Helvetica 的情况？
- [ ] **表格规范**: 表格是否实现了斑马纹（`Slate-50` 交替行）、悬浮高亮（`Indigo-50`）？表头是否固定？列宽是否合理（数字列紧凑、名称列自适应）？
- [ ] **筛选栏布局**: 筛选栏是否为水平紧凑布局（搜索框 + 下拉 + 按钮同行），还是使用了垂直堆叠（违规）？筛选栏是否以白色卡片 `rounded-lg` 包裹？
- [ ] **表单规范**: 表单是否使用垂直标签布局？标签是否为 `Slate-600 13px/500`？输入框高度是否为 `38px`？聚焦时是否有 `ring-2 ring-Indigo-500`？
- [ ] **图片上传区**: 是否使用虚线边框 `border-dashed`？主图角标是否使用 `bg-Indigo-600 text-white`？是否支持拖拽排序？
- [ ] **批量操作栏**: 是否为底部浮出式 `fixed bottom-0 bg-Indigo-600 text-white`？是否显示选中数量？
- [ ] **动效克制**: Admin 是否仅使用了 `transition-all duration-150` 的极简过渡？是否存在 fade-up、parallax、CountUp 等花哨动画（违规— 这些属于 Web 前台）？

### Web 前台视觉合规
- [ ] **色彩体系**: 主色是否使用深海蓝 `#0C2340`？强调色是否使用暖金 `#C9A96E`？是否存在与 Admin 相同的 `Indigo-600` 用色（违规— 两端不应混用）？
- [ ] **排版字体**: 标题是否使用 `Playfair Display`（衬线体）？正文是否使用 `Inter`（无衬线）？邮轮名称是否为 `32px/700 Playfair Display`？价格是否为 `24px/700 Inter` 暖金色？是否存在使用系统默认字体的遗漏？
- [ ] **Hero Banner**: 邮轮列表页是否有全宽 `50vh` 的 Hero 区域？是否有渐变叠加层 `linear-gradient(180deg, rgba(12,35,64,0) 0%, rgba(12,35,64,0.85) 100%)`？标题是否为 `Playfair Display text-5xl text-white`？
- [ ] **卡片设计**: 邮轮卡片封面图是否为 `aspect-[4/3]`？hover 时是否有 `scale-105 transition-transform duration-500` 放大效果？底部链接是否使用暖金色 + 箭头动画？
- [ ] **沉浸式轮播**: 详情页轮播高度是否 ≥`60vh`？是否有半透明白色圆形左右箭头？是否有底部圆点指示器？
- [ ] **动效丰富度**: 是否实现了页面滚动视差（Hero 图 `background-attachment: fixed`）？卡片入场是否有 `fade-up` 动画（交错延迟）？数字是否有 CountUp 滚动效果？按钮 hover 是否有 `translateY(-2px) + shadow-lg`？
- [ ] **设施标签颜色**: 免费设施是否使用 `bg-emerald-50 text-emerald-700`？收费设施是否使用 `bg-amber-50 text-amber-700`？
- [ ] **CTA 栏**: 底部固定 CTA 是否使用 `sticky bottom-0`？背景是否为深海蓝？按钮是否为白色？
- [ ] **响应式断点**: 是否在 `sm/md/lg/xl` 四个断点下均有合理布局？移动端卡片是否改为单列？详情页是否改为单栏？

### Miniapp 小程序视觉合规
- [ ] **色彩体系**: 价格和 CTA 是否使用珊瑚橘 `#FF6B6B`？"可用"状态是否使用清远青 `#26A69A`？页面背景是否为 `#F5F5F5`？是否存在使用深海蓝 `#0C2340` 或暖金 `#C9A96E` 的 Web 风格色彩混入（严重违规）？
- [ ] **字体与单位**: 是否全部使用系统默认字体（`-apple-system, 'PingFang SC'`）？是否禁止引入外部字体文件？单位是否全部使用 `rpx`？是否存在 `px` 单位（违规）？全文搜索 `.vue` 文件中的 `px` 确认。
- [ ] **卡片圆角与阴影**: 卡片是否使用 `border-radius: 16rpx`？阴影是否为轻量级 `box-shadow: 0 2rpx 12rpx rgba(0,0,0,0.06)`（微信风格）而非 Web 端的 `shadow-xl`？
- [ ] **Swiper 轮播**: 是否使用了原生 `<swiper>` 而非 Web 组件？高度是否为 `480rpx`？指示器样式是否合理？
- [ ] **触控目标**: 所有可点击元素的尺寸是否 ≥`88rpx * 88rpx`？底部操作栏按钮高度是否 ≥`88rpx`？`border-radius` 是否为 `44rpx`（圆角大按钮）？
- [ ] **安全区适配**: 底部操作栏是否使用了 `padding-bottom: env(safe-area-inset-bottom)` 适配 iPhone X 系列？
- [ ] **骨架屏**: 列表页加载态是否使用了 `skeleton` 骨架屏而非 spinner？
- [ ] **图片组件**: 是否全部使用 `<image mode="aspectFill">` 而非 HTML `<img>`？
- [ ] **动效克制**: 小程序是否仅使用 CSS `transition` 或 `wx.createAnimation`？是否禁止了 `@vueuse/motion`、`gsap` 等 Web 端动画库？

### C 端内容一致性
- [ ] **数据一致性**: Web 前台和小程序前台展示的以下内容是否完全一致（调用相同 API、展示相同字段）？
  - 邮轮基本参数（7 项：吨位、载客量、船员数、长度、宽度、甲板数、建造/翻新年份）
  - 舱房类型列表（名称、面积范围、入住人数、起始价格、图片、设施清单）
  - 设施导览（分类、名称、位置、收费标识、图片）
  - 舱位属性标签（位置、朝向、窗户、阳台、床型、设施）
  - 价格日历（所有价格类型的价格数值）
  - 库存状态（充足/紧张/即将售罄的阈值逻辑一致）
  - 关联航线（出发日期、航线名称、最低价）
- [ ] **差异仅限视觉**: 上述一致内容中，两端是否仅在视觉呈现方式上有所不同（如 Web 用 Accordion 而小程序用列表展开；Web 用进度条而小程序用文字标签）？如果发现某个数据点在一端显示了但在另一端遗漏了，标记为阻塞性问题。

### 三端差异化验证
- [ ] **禁止三端同质**: 打开 Admin、Web、Miniapp 的邮轮列表/详情页截图或代码对比。三端的视觉呈现是否明显不同？如果发现 Web 前台和 Miniapp 使用了完全相同的 CSS/颜色/字体/布局（即"一套代码三端共用"），标记为阻塞性问题。
- [ ] **Admin 不应"美观"过度**: Admin 是否保持了克制的工具型风格？如果发现 Admin 使用了 Hero Banner、Playfair Display 衬线字体、视差滚动等面向消费者的设计元素，标记为违规。
- [ ] **Web 不应"简陋"**: Web 前台是否达到了高端旅行品牌官网的品质感？如果发现 Web 前台使用了 Admin 风格的朴素表格、无衬线标题、无动效的平面设计，标记为违规——Web 前台必须给用户 WOW 感。

**执行动作**：逐端逐页截图对比审计。对照以上 Checklist 逐条检查色彩、字体、布局、动效、组件风格。只要有一条不符，输出红色的整改方案。

---

## 综合终审 Checklist

完成上述七个维度审计后，执行最终综合检查：

- [ ] **功能完整性**: 对照 @docs/plans/2026-02-28-sprint04.1.md 中的 23 个 Task，逐一确认是否全部完成。
- [ ] **Specify 覆盖率**: 对照 @功能列表.md 中 Specify A.1~A.4 和 B 各子项，逐条勾选已实现并验证的功能。未实现的功能必须列出并标记为阻塞性问题。
- [ ] **编译零错误**: `cd backend && go build ./...` 必须无任何编译错误或警告。
- [ ] **共享类型同步**: `frontend/shared/types/index.ts` 中的类型定义是否与后端 domain struct 和 API 响应 JSON 字段完全一致？
- [ ] **中文注释**: 所有新增/修改的 Go 文件是否包含中文注释说明？是否符合项目既有的注释风格？
- [ ] **Git 提交规范**: 每个 Task 是否有独立的 commit，commit message 是否遵循 `feat:` / `fix:` / `test:` / `docs:` 前缀规范？
- [ ] **视觉设计合格**: 三端视觉设计是否均符合对应的设计规范？是否存在三端同质化？Web 前台是否具有高端品质感？Admin 是否保持了专业克制？小程序是否符合微信原生风格？
- [ ] **C 端数据一致**: Web 前台和小程序前台展示的所有业务数据是否完全一致？差异是否仅限于视觉呈现？

**执行动作**：完成全部七个维度 + 综合终审后，如果所有 Checklist 全部通过，输出绿色的 **APPROVED** 标记。如果有任何一项未通过，汇总所有整改项，生成整改方案文档，要求开发者修复后重新提交 Review。
