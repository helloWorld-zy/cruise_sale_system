# Sprint 4.1: é‚®è½®ä»‹ç»æ¨¡å— + èˆ±ä½å•†å“ç®¡ç† å®Œæ•´å®ç°

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**ç›®æ ‡ï¼š** å®Œæ•´å®ç°åŠŸèƒ½åˆ—è¡¨ Specify ä¸­çš„ **A. é‚®è½®ä»‹ç»æ¨¡å—ï¼ˆA.1~A.4ï¼‰** å’Œ **B. èˆ±ä½å•†å“ç®¡ç†**ï¼Œè¡¥é½ç°æœ‰ä»£ç ä¸­ç¼ºå¤±çš„å­—æ®µã€æ¥å£ã€é¡µé¢å’Œæµ‹è¯•ã€‚

**èƒŒæ™¯ï¼š** Sprint 1~4 å·²å»ºç«‹åŸºç¡€çš„ Cruise/CabinType/Facility/CabinSKU æ¨¡å‹ä¸ CRUDï¼Œä½†ä¸åŠŸèƒ½åˆ—è¡¨ Specify å¯¹æ¯”ä»æœ‰å¤§é‡å­—æ®µå’ŒåŠŸèƒ½ç¼ºå¤±ã€‚æœ¬ Sprint å°†å¯¹å·²æœ‰ä»£ç è¿›è¡Œå¢é‡ä¿®æ”¹ï¼ˆå…è®¸è·¨å±‚ä¿®æ”¹å·²æœ‰æ–‡ä»¶ï¼‰ï¼Œä½¿ä¹‹å®Œæ•´è¦†ç›– Specify è¦æ±‚ã€‚

**æŠ€æœ¯æ ˆï¼š** Go 1.26, Gin, GORM, PostgreSQL 17, Redis 7.4, Nuxt 4, Vue 3, Pinia, Vitest, uni-app.

**TDD çº¦å®šï¼š** å…ˆå†™å¤±è´¥æµ‹è¯• (RED) â†’ æœ€å°å®ç° (GREEN) â†’ é‡æ„ (REFACTOR) â†’ éªŒè¯é€šè¿‡ â†’ æäº¤ã€‚æ‰€æœ‰ä»£ç  100% æµ‹è¯•è¦†ç›–ç‡ã€‚Vue å¿…é¡» `<script setup lang="ts">`ã€‚ä¸­æ–‡æ³¨é‡Šã€‚

---

## Part A: åç«¯ â€” é‚®è½®ä»‹ç»æ¨¡å—æ‰©å±• (Tasks 1-8)

### Task 1: Cruise é¢†åŸŸæ¨¡å‹æ‰©å±•

**ç›®æ ‡ï¼š** ä¸º `Cruise` è¡¥é½ Specify A.1 è¦æ±‚çš„å…¨éƒ¨å­—æ®µã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/cruise.go`
- Modify: `backend/internal/domain/cruise_test.go`ï¼ˆè‹¥æ— åˆ™åˆ›å»ºï¼‰

**RED**

åˆ›å»º/ä¿®æ”¹ `backend/internal/domain/cruise_test.go`ï¼š

```go
package domain

import "testing"

func TestCruiseExtendedFields(t *testing.T) {
    c := Cruise{
        Code:          "HARMONY",
        CrewCount:     2200,
        Length:        362.0,
        Width:         66.0,
        DeckCount:     18,
        RefurbishYear: 2024,
        Status:        2, // ç»´æŠ¤ä¸­
    }
    if c.Code == "" { t.Fatal("expected code") }
    if c.CrewCount == 0 { t.Fatal("expected crew_count") }
    if c.Length == 0 { t.Fatal("expected length") }
    if c.Width == 0 { t.Fatal("expected width") }
    if c.DeckCount == 0 { t.Fatal("expected deck_count") }
    if c.RefurbishYear == 0 { t.Fatal("expected refurbish_year") }
    if c.Status != 2 { t.Fatal("expected status 2") }
}
```

è¿è¡Œï¼š`cd backend && go test ./internal/domain -run TestCruiseExtendedFields -v` â†’ FAIL

**GREEN**

ä¿®æ”¹ `backend/internal/domain/cruise.go`ï¼Œåœ¨ç°æœ‰ `Cruise` struct ä¸­æ–°å¢å­—æ®µï¼š

```go
type Cruise struct {
    ID                int64          `gorm:"primaryKey" json:"id"`
    CompanyID         int64          `gorm:"index;not null" json:"company_id"`
    Company           *CruiseCompany `gorm:"foreignKey:CompanyID" json:"company,omitempty"`
    Name              string         `gorm:"size:100;not null" json:"name"`
    EnglishName       string         `gorm:"size:100" json:"english_name"`
    Code              string         `gorm:"size:50;uniqueIndex" json:"code"`              // è‹±æ–‡ç®€ç§°/ä»£ç 
    CrewCount         int            `json:"crew_count"`                                    // èˆ¹å‘˜äººæ•°
    BuildYear         int            `json:"build_year"`
    RefurbishYear     int            `json:"refurbish_year"`                                // æœ€è¿‘ç¿»æ–°å¹´ä»½
    Tonnage           float64        `json:"tonnage"`
    PassengerCapacity int            `json:"passenger_capacity"`
    RoomCount         int            `json:"room_count"`
    Length            float64        `json:"length"`                                        // æ€»é•¿åº¦ï¼ˆç±³ï¼‰
    Width             float64        `json:"width"`                                         // æ€»å®½åº¦ï¼ˆç±³ï¼‰
    DeckCount         int            `json:"deck_count"`                                    // ç”²æ¿å±‚æ•°
    Description       string         `gorm:"type:text" json:"description"`
    Status            int16          `gorm:"default:1" json:"status"`                       // 1=ä¸Šæ¶,0=ä¸‹æ¶,2=ç»´æŠ¤ä¸­
    SortOrder         int            `gorm:"default:0" json:"sort_order"`
    CreatedAt         time.Time      `json:"created_at"`
    UpdatedAt         time.Time      `json:"updated_at"`
    DeletedAt         *time.Time     `gorm:"index" json:"deleted_at,omitempty"`
}
```

è¿è¡Œï¼š`cd backend && go test ./internal/domain -run TestCruiseExtendedFields -v` â†’ PASS

**REFACTOR**

æ— ã€‚

**æäº¤ï¼š** `git add backend/internal/domain/cruise.go backend/internal/domain/cruise_test.go && git commit -m "feat: extend cruise model with code/crew/dimensions/refurbish fields"`

---

### Task 2: CabinType é¢†åŸŸæ¨¡å‹æ‰©å±•

**ç›®æ ‡ï¼š** è¡¥é½ Specify A.2 è¦æ±‚çš„å…¨éƒ¨å­—æ®µï¼ˆç±»å‹ä»£ç ã€é¢ç§¯èŒƒå›´ã€æœ€å¤§å…¥ä½äººæ•°ã€åºŠå‹ã€æ ‡ç­¾ã€è®¾æ–½æ¸…å•ã€å¹³é¢å›¾ç­‰ï¼‰ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/cabin_type.go`
- Create: `backend/internal/domain/cabin_type_test.go`

**RED**

```go
package domain

import "testing"

func TestCabinTypeExtendedFields(t *testing.T) {
    ct := CabinType{
        Code:        "BALCONY",
        AreaMin:     28.0,
        AreaMax:     35.0,
        MaxCapacity: 4,
        BedType:     "åŒäººåºŠ/å¯æ‹†åˆ†ä¸ºä¸¤å¼ å•äººåºŠ",
        Tags:        "è½åœ°çª—,ç§äººé˜³å°,ç®¡å®¶æœåŠ¡",
        Amenities:   "ç‹¬ç«‹å«æµ´,å¹é£æœº,ä¿é™©ç®±,è¿·ä½ å§,ç”µè§†",
        FloorPlanURL: "https://example.com/plan.jpg",
    }
    if ct.Code == "" { t.Fatal("expected code") }
    if ct.AreaMin == 0 { t.Fatal("expected area_min") }
    if ct.AreaMax == 0 { t.Fatal("expected area_max") }
    if ct.MaxCapacity == 0 { t.Fatal("expected max_capacity") }
    if ct.BedType == "" { t.Fatal("expected bed_type") }
    if ct.Tags == "" { t.Fatal("expected tags") }
    if ct.Amenities == "" { t.Fatal("expected amenities") }
    if ct.FloorPlanURL == "" { t.Fatal("expected floor_plan_url") }
}
```

è¿è¡Œï¼š`cd backend && go test ./internal/domain -run TestCabinTypeExtendedFields -v` â†’ FAIL

**GREEN**

ä¿®æ”¹ `backend/internal/domain/cabin_type.go`ï¼š

```go
type CabinType struct {
    ID           int64      `gorm:"primaryKey" json:"id"`
    CruiseID     int64      `gorm:"index;not null" json:"cruise_id"`
    Name         string     `gorm:"size:100;not null" json:"name"`
    EnglishName  string     `gorm:"size:100" json:"english_name"`
    Code         string     `gorm:"size:50" json:"code"`                  // èˆ±æˆ¿ç±»å‹ä»£ç 
    AreaMin      float64    `json:"area_min"`                             // æœ€å°é¢ç§¯ï¼ˆå¹³æ–¹ç±³ï¼‰
    AreaMax      float64    `json:"area_max"`                             // æœ€å¤§é¢ç§¯ï¼ˆå¹³æ–¹ç±³ï¼‰
    Area         float64    `json:"area"`                                 // å…¼å®¹æ—§å­—æ®µ
    Capacity     int        `gorm:"default:2" json:"capacity"`            // æ ‡å‡†å…¥ä½äººæ•°
    MaxCapacity  int        `json:"max_capacity"`                         // æœ€å¤§å…¥ä½äººæ•°
    BedType      string     `gorm:"size:200" json:"bed_type"`             // åºŠå‹è¯´æ˜
    Tags         string     `gorm:"size:500" json:"tags"`                 // ç‰¹è‰²æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰
    Amenities    string     `gorm:"type:text" json:"amenities"`           // è®¾æ–½æ¸…å•ï¼ˆé€—å·åˆ†éš”ï¼‰
    FloorPlanURL string     `gorm:"size:500" json:"floor_plan_url"`       // å¹³é¢å›¾ URL
    Deck         string     `gorm:"size:50" json:"deck"`
    Description  string     `gorm:"type:text" json:"description"`         // å¯Œæ–‡æœ¬è¯¦ç»†ä»‹ç»
    Status       int16      `gorm:"default:1" json:"status"`
    SortOrder    int        `gorm:"default:0" json:"sort_order"`
    CreatedAt    time.Time  `json:"created_at"`
    UpdatedAt    time.Time  `json:"updated_at"`
    DeletedAt    *time.Time `gorm:"index" json:"deleted_at,omitempty"`
}
```

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: extend cabin_type model with code/area-range/bed/tags/amenities/floor-plan"`

---

### Task 3: Facility + FacilityCategory é¢†åŸŸæ¨¡å‹æ‰©å±•

**ç›®æ ‡ï¼š** è¡¥é½ Specify A.3 è¦æ±‚çš„å­—æ®µã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/facility.go`
- Modify: `backend/internal/domain/facility_category.go`
- Create: `backend/internal/domain/facility_test.go`

**RED**

```go
package domain

import "testing"

func TestFacilityExtendedFields(t *testing.T) {
    f := Facility{
        OpenHours:      "08:00-22:00",
        ExtraCharge:    true,
        ChargePriceTip: "å‚è€ƒä»· Â¥200/äºº",
        TargetAudience: "å®¶åº­,æƒ…ä¾£,å„¿ç«¥",
    }
    if f.OpenHours == "" { t.Fatal("expected open_hours") }
    if !f.ExtraCharge { t.Fatal("expected extra_charge") }
    if f.ChargePriceTip == "" { t.Fatal("expected charge_price_tip") }
    if f.TargetAudience == "" { t.Fatal("expected target_audience") }
}

func TestFacilityCategoryExtendedFields(t *testing.T) {
    fc := FacilityCategory{Status: 1}
    if fc.Status == 0 { t.Fatal("expected status") }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

ä¿®æ”¹ `backend/internal/domain/facility.go`ï¼šæ–°å¢ `OpenHours string`, `ExtraCharge bool`, `ChargePriceTip string`, `TargetAudience string` å­—æ®µã€‚

ä¿®æ”¹ `backend/internal/domain/facility_category.go`ï¼šæ–°å¢ `Status int16 gorm:"default:1"` å­—æ®µã€‚

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: extend facility models with open-hours/charge/audience/status"`

---

### Task 4: Image æ¨¡å‹æ‰©å±• + å›¾ç‰‡ä»“å‚¨

**ç›®æ ‡ï¼š** ä¸º `Image` æ·»åŠ  `IsPrimary` æ ‡è®°ï¼Œæ–°å¢ `ImageRepository` æ¥å£ï¼Œæ”¯æŒé‚®è½®å°é¢å›¾ã€èˆ±æˆ¿å›¾ç‰‡ç”»å»Šã€è®¾æ–½å›¾ç‰‡çš„å¤šæ€ç®¡ç†ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/image.go`
- Modify: `backend/internal/domain/repository.go`
- Create: `backend/internal/repository/image_repo.go`
- Create: `backend/internal/repository/image_repo_test.go`

**RED**

```go
// image_repo_test.go
package repository

import (
    "context"
    "testing"
    "github.com/cruisebooking/backend/internal/domain"
    "gorm.io/driver/sqlite"
    "gorm.io/gorm"
)

func TestImageRepository_CRUD(t *testing.T) {
    db, _ := gorm.Open(sqlite.Open(":memory:"), &gorm.Config{})
    db.AutoMigrate(&domain.Image{})
    repo := NewImageRepository(db)
    ctx := context.Background()

    img := &domain.Image{EntityType: "cruise", EntityID: 1, URL: "https://img.com/1.jpg", IsPrimary: true}
    if err := repo.Create(ctx, img); err != nil { t.Fatal(err) }

    list, err := repo.ListByEntity(ctx, "cruise", 1)
    if err != nil { t.Fatal(err) }
    if len(list) != 1 { t.Fatalf("expected 1, got %d", len(list)) }
    if !list[0].IsPrimary { t.Fatal("expected primary") }

    if err := repo.DeleteByEntity(ctx, "cruise", 1); err != nil { t.Fatal(err) }
    list2, _ := repo.ListByEntity(ctx, "cruise", 1)
    if len(list2) != 0 { t.Fatal("expected 0 after delete") }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

ä¿®æ”¹ `backend/internal/domain/image.go`ï¼šæ·»åŠ  `IsPrimary bool` å­—æ®µã€‚

åœ¨ `backend/internal/domain/repository.go` æ·»åŠ ï¼š

```go
type ImageRepository interface {
    Create(ctx context.Context, img *Image) error
    ListByEntity(ctx context.Context, entityType string, entityID int64) ([]Image, error)
    DeleteByEntity(ctx context.Context, entityType string, entityID int64) error
    UpdateSortOrder(ctx context.Context, id int64, sortOrder int) error
}
```

åˆ›å»º `backend/internal/repository/image_repo.go`ï¼šå®ç° `ImageRepository`ï¼Œä½¿ç”¨ GORM æŸ¥è¯¢ `entity_type + entity_id`ã€‚

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add image repository with multi-entity support"`

---

### Task 5: æ•°æ®åº“è¿ç§» â€” æ‰©å±•å­—æ®µ + å›¾ç‰‡ä»“å‚¨

**Filesï¼š**
- Create: `backend/migrations/000005_sprint41_extend.up.sql`
- Create: `backend/migrations/000005_sprint41_extend.down.sql`
- Create: `backend/migrations/migrations_sprint41_test.go`

**RED**

```go
package migrations

import ("os"; "testing")

func TestSprint41MigrationFilesExist(t *testing.T) {
    for _, f := range []string{"000005_sprint41_extend.up.sql", "000005_sprint41_extend.down.sql"} {
        if _, err := os.Stat(f); err != nil { t.Fatalf("missing %s", f) }
    }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

`000005_sprint41_extend.up.sql`ï¼š

```sql
-- Cruise æ‰©å±•å­—æ®µ
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS code VARCHAR(50) UNIQUE;
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS crew_count INT DEFAULT 0;
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS refurbish_year INT DEFAULT 0;
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS length DOUBLE PRECISION DEFAULT 0;
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS width DOUBLE PRECISION DEFAULT 0;
ALTER TABLE cruises ADD COLUMN IF NOT EXISTS deck_count INT DEFAULT 0;

-- CabinType æ‰©å±•å­—æ®µ
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS code VARCHAR(50);
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS area_min DOUBLE PRECISION DEFAULT 0;
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS area_max DOUBLE PRECISION DEFAULT 0;
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS max_capacity INT DEFAULT 0;
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS bed_type VARCHAR(200);
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS tags VARCHAR(500);
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS amenities TEXT;
ALTER TABLE cabin_types ADD COLUMN IF NOT EXISTS floor_plan_url VARCHAR(500);

-- Facility æ‰©å±•å­—æ®µ
ALTER TABLE facilities ADD COLUMN IF NOT EXISTS open_hours VARCHAR(100);
ALTER TABLE facilities ADD COLUMN IF NOT EXISTS extra_charge BOOLEAN DEFAULT FALSE;
ALTER TABLE facilities ADD COLUMN IF NOT EXISTS charge_price_tip VARCHAR(200);
ALTER TABLE facilities ADD COLUMN IF NOT EXISTS target_audience VARCHAR(200);

-- FacilityCategory æ‰©å±•
ALTER TABLE facility_categories ADD COLUMN IF NOT EXISTS status SMALLINT DEFAULT 1;

-- Image æ‰©å±•
ALTER TABLE images ADD COLUMN IF NOT EXISTS is_primary BOOLEAN DEFAULT FALSE;

-- ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_cruises_code ON cruises(code);
CREATE INDEX IF NOT EXISTS idx_cruises_status ON cruises(status);
CREATE INDEX IF NOT EXISTS idx_cabin_types_code ON cabin_types(code);
CREATE INDEX IF NOT EXISTS idx_images_entity ON images(entity_type, entity_id);
```

`000005_sprint41_extend.down.sql`ï¼šç¼–å†™ DROP COLUMN è¯­å¥å›æ»šã€‚

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add sprint 4.1 migrations for extended fields"`

---

### Task 6: æ‰©å±• Repository å±‚ â€” Cruise é«˜çº§ç­›é€‰ã€CabinType/Facility å®Œå–„

**ç›®æ ‡ï¼š** ä¸ºé‚®è½®åˆ—è¡¨å¢åŠ åç§°/å¨ä½/çŠ¶æ€ç­›é€‰ä¸æ’åºï¼›CabinType æŒ‰é‚®è½®+çŠ¶æ€ç­›é€‰ï¼›Facility æŒ‰é‚®è½®+åˆ†ç±»ç­›é€‰ï¼›è¡¥é½ Update/GetByID ç¼ºå£ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/repository.go` â€” æ›´æ–° `CruiseRepository.List` ç­¾åï¼Œå¢åŠ  `CabinTypeRepository.Update`, `FacilityRepository.Update/GetByID`
- Modify: `backend/internal/repository/cruise_repo.go`
- Modify: `backend/internal/repository/cabin_type_repo.go`
- Modify: `backend/internal/repository/facility_repo.go`
- Modify: `backend/internal/repository/facility_category_repo.go`
- Create/Modify: å¯¹åº” `_test.go` æ–‡ä»¶

**RED**

ä¸º `cruise_repo_test.go` æ·»åŠ ç­›é€‰æµ‹è¯•ï¼š

```go
func TestCruiseRepository_ListWithFilters(t *testing.T) {
    db, _ := gorm.Open(sqlite.Open(":memory:"), &gorm.Config{})
    db.AutoMigrate(&domain.Cruise{})
    repo := NewCruiseRepository(db)
    ctx := context.Background()

    repo.Create(ctx, &domain.Cruise{Name: "æµ·æ´‹é‡å­å·", Status: 1, Tonnage: 168000})
    repo.Create(ctx, &domain.Cruise{Name: "åœ°ä¸­æµ·å·", Status: 0, Tonnage: 90000})

    // æŒ‰åç§°ç­›é€‰
    items, total, err := repo.List(ctx, 0, "æµ·æ´‹", 0, "", 1, 10)
    if err != nil { t.Fatal(err) }
    if total != 1 || len(items) != 1 { t.Fatal("expected 1 result filtered by name") }

    // æŒ‰çŠ¶æ€ç­›é€‰
    items2, total2, _ := repo.List(ctx, 0, "", 1, "", 1, 10)
    if total2 != 1 { t.Fatalf("expected 1 active, got %d", total2) }
    _ = items2
}
```

è¿è¡Œ â†’ FAILï¼ˆList ç­¾åä¸åŒ¹é…ï¼‰

**GREEN**

æ›´æ–° `CruiseRepository` æ¥å£ç­¾åï¼š

```go
type CruiseRepository interface {
    Create(ctx context.Context, cruise *Cruise) error
    Update(ctx context.Context, cruise *Cruise) error
    GetByID(ctx context.Context, id int64) (*Cruise, error)
    List(ctx context.Context, companyID int64, keyword string, status int16, sortBy string, page, pageSize int) ([]Cruise, int64, error)
    Delete(ctx context.Context, id int64) error
}
```

åœ¨ `cruise_repo.go` å®ç°å¸¦ keyword/status/sortBy çš„æŸ¥è¯¢é€»è¾‘ã€‚åŒæ­¥ä¿®æ”¹ `CruiseService` å’Œ `CruiseHandler` çš„è°ƒç”¨æ–¹é€‚é…æ–°ç­¾åã€‚

åŒæ—¶æ‰©å±• `FacilityRepository` æ·»åŠ  `Update`, `GetByID`, `ListByCruiseAndCategory` æ–¹æ³•ï¼›æ‰©å±• `FacilityCategoryRepository` æ·»åŠ  `Update`, `GetByID` æ–¹æ³•ã€‚

è¿è¡Œ â†’ PASS

**REFACTOR** â€” æå–é€šç”¨åˆ†é¡µæŸ¥è¯¢ helperã€‚

**æäº¤ï¼š** `git commit -m "feat: extend cruise/cabin-type/facility repos with advanced filtering"`

---

### Task 7: æ‰©å±• Service å±‚ â€” ä¸šåŠ¡è§„åˆ™å®Œå–„

**ç›®æ ‡ï¼š** æ›´æ–° CruiseServiceã€CabinTypeServiceã€FacilityServiceã€FacilityCategoryService æ”¯æŒæ‰©å±•å­—æ®µå’Œæ–°ä¸šåŠ¡è§„åˆ™ï¼ˆå¦‚é‚®è½®æ‰¹é‡ä¸Šä¸‹æ¶ã€åˆ é™¤å‰æ£€æŸ¥å…³è”èˆªçº¿ã€èˆ±æˆ¿ç±»å‹çŠ¶æ€åˆ‡æ¢ç­‰ï¼‰ã€‚

**Filesï¼š**
- Modify: `backend/internal/service/cruise_service.go`
- Modify: `backend/internal/service/cabin_type_service.go`
- Modify: `backend/internal/service/facility_service.go`
- Modify: `backend/internal/service/facility_category_service.go`
- Create: `backend/internal/service/image_service.go`
- Create: å¯¹åº” `_test.go` æ–‡ä»¶

**RED**

```go
// cruise_service_extended_test.go
package service

import ("context"; "testing")

func TestCruiseService_BatchUpdateStatus(t *testing.T) {
    repo := &mockCruiseRepoFull{}
    svc := NewCruiseService(repo, &mockCabinRepo{}, &mockCompanyRepo{})
    err := svc.BatchUpdateStatus(context.Background(), []int64{1, 2}, 0)
    if err != nil { t.Fatal("expected success") }
}

func TestImageService_ManageGallery(t *testing.T) {
    repo := &mockImageRepo{}
    svc := NewImageService(repo)
    err := svc.SetImages(context.Background(), "cruise", 1, []ImageInput{{URL: "http://a.jpg", IsPrimary: true}})
    if err != nil { t.Fatal(err) }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

åœ¨ `CruiseService` ä¸­æ·»åŠ ï¼š
- `BatchUpdateStatus(ctx, ids []int64, status int16) error` â€” æ‰¹é‡ä¸Šä¸‹æ¶
- `ListWithFilters(ctx, companyID, keyword, status, sortBy, page, pageSize)` â€” è½¬å‘ repo æ–°æ¥å£

åˆ›å»º `image_service.go`ï¼š
- `ImageService` è´Ÿè´£ç®¡ç†å›¾ç‰‡ç”»å»Šï¼ˆSetImages å…ˆåˆ æ—§å†æ‰¹é‡åˆ›å»ºï¼‰
- `SetImages(ctx, entityType, entityID, images []ImageInput)` 
- `ListImages(ctx, entityType, entityID)`

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add batch status update and image service"`

---

### Task 8: æ‰©å±• Handler + Router â€” é‚®è½®ä»‹ç»åå° API å®Œå–„

**ç›®æ ‡ï¼š** æ›´æ–° Handler å±‚æ”¯æŒæ‰©å±•å­—æ®µçš„è¯·æ±‚/å“åº”ï¼›æ–°å¢å›¾ç‰‡ç®¡ç† APIï¼›æ›´æ–° Router æ·»åŠ æ–°è·¯ç”±ã€‚

**Filesï¼š**
- Modify: `backend/internal/handler/cruise_handler.go` â€” `CruiseRequest` å¢åŠ æ–°å­—æ®µï¼Œå¢åŠ  `BatchUpdateStatus` handler
- Modify: `backend/internal/handler/cabin_type_handler.go` â€” è¯·æ±‚ä½“æ‰©å±•
- Modify: `backend/internal/handler/facility_handler.go` â€” è¯·æ±‚ä½“æ‰©å±•, å¢åŠ  Update/Get
- Modify: `backend/internal/handler/facility_category_handler.go` â€” å¢åŠ  Update
- Create: `backend/internal/handler/image_handler.go` â€” å›¾ç‰‡ CRUD
- Modify: `backend/internal/router/router.go` â€” æ³¨å†Œæ–°è·¯ç”±
- ä¿®æ”¹/åˆ›å»ºå¯¹åº” `_test.go` æ–‡ä»¶

**RED**

```go
// cruise_handler_extended_test.go
package handler

import ("net/http"; "net/http/httptest"; "strings"; "testing"; "github.com/gin-gonic/gin")

func TestCruiseBatchStatus(t *testing.T) {
    gin.SetMode(gin.TestMode)
    r := gin.New()
    h := NewCruiseHandler(newMockCruiseSvc())
    r.PUT("/api/v1/admin/cruises/batch-status", h.BatchUpdateStatus)
    body := `{"ids":[1,2],"status":0}`
    w := httptest.NewRecorder()
    r.ServeHTTP(w, httptest.NewRequest("PUT", "/api/v1/admin/cruises/batch-status", strings.NewReader(body)))
    if w.Code != http.StatusOK { t.Fatalf("expected 200, got %d", w.Code) }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

æ›´æ–° `CruiseRequest` ç»“æ„ä½“ï¼Œæ–°å¢ `Code`, `CrewCount`, `RefurbishYear`, `Length`, `Width`, `DeckCount` å­—æ®µã€‚

æ–°å¢ `CruiseHandler.BatchUpdateStatus` æ–¹æ³•ï¼šè§£æ `{ids, status}` JSONï¼Œè°ƒç”¨ `svc.BatchUpdateStatus`ã€‚

åˆ›å»º `image_handler.go`ï¼Œæä¾›ï¼š
- `POST /admin/images` â€” ä¿å­˜å›¾ç‰‡åˆ—è¡¨å…³è” `{ entity_type, entity_id, images: [{url, sort_order, is_primary}] }`
- `GET /admin/images?entity_type=cruise&entity_id=1` â€” æŸ¥è¯¢å›¾ç‰‡

æ›´æ–° `router.go`ï¼š
- `cruises.PUT("/batch-status", deps.Cruise.BatchUpdateStatus)`
- æ–°å¢ `images` è·¯ç”±ç»„
- è®¾æ–½è·¯ç”±å¢åŠ  `PUT /:id` å’Œ `GET /:id`

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: extend handlers + router for cruise intro module"`

---

## Part B: åç«¯ â€” èˆ±ä½å•†å“ç®¡ç†æ‰©å±• (Tasks 9-13)

### Task 9: CabinSKU æ¨¡å‹æ‰©å±• â€” å®Œå–„ SKU å±æ€§

**ç›®æ ‡ï¼š** ä¸º `CabinSKU` è¡¥é½ Specify B ä¸­çš„èˆ±ä½å±æ€§ï¼ˆä½ç½®ã€æœå‘ã€çª—æˆ·/é˜³å°ã€é™„å±è®¾æ–½ç­‰ï¼‰ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/cabin.go`
- Create: `backend/internal/domain/cabin_extended_test.go`

**RED**

```go
func TestCabinSKUExtendedFields(t *testing.T) {
    sku := CabinSKU{
        Position:      "mid",
        Orientation:   "port",
        HasWindow:     true,
        HasBalcony:    true,
        BedType:       "å¤§åºŠ",
        Amenities:     "å«æµ´,è¿·ä½ å§,ç”µè§†",
        CabinTypeID:   1,
    }
    if sku.Position == "" { t.Fatal("expected position") }
    if sku.Orientation == "" { t.Fatal("expected orientation") }
    if !sku.HasWindow { t.Fatal("expected has_window") }
    if !sku.HasBalcony { t.Fatal("expected has_balcony") }
    if sku.BedType == "" { t.Fatal("expected bed_type") }
    if sku.Amenities == "" { t.Fatal("expected amenities") }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

ä¿®æ”¹ `cabin.go` ä¸­ `CabinSKU`ï¼š

```go
type CabinSKU struct {
    ID          int64     `gorm:"primaryKey" json:"id"`
    VoyageID    int64     `gorm:"index" json:"voyage_id"`
    CabinTypeID int64     `gorm:"index" json:"cabin_type_id"`
    Code        string    `gorm:"size:80;uniqueIndex" json:"code"`
    Deck        string    `gorm:"size:20" json:"deck"`
    Area        float64   `json:"area"`
    MaxGuests   int       `json:"max_guests"`
    Position    string    `gorm:"size:20" json:"position"`              // ä½ç½®ï¼šfore/mid/aft
    Orientation string    `gorm:"size:20" json:"orientation"`           // æœå‘ï¼šport/starboard
    HasWindow   bool      `json:"has_window"`                           // æ˜¯å¦æœ‰çª—
    HasBalcony  bool      `json:"has_balcony"`                          // æ˜¯å¦æœ‰é˜³å°
    BedType     string    `gorm:"size:100" json:"bed_type"`             // åºŠå‹
    Amenities   string    `gorm:"type:text" json:"amenities"`           // é™„å±è®¾æ–½
    Status      int16     `gorm:"default:1" json:"status"`
    CreatedAt   time.Time `json:"created_at"`
    UpdatedAt   time.Time `json:"updated_at"`
}
```

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: extend cabin SKU with position/orientation/bed/amenities"`

---

### Task 10: CabinSKU Repository æ‰©å±• â€” é«˜çº§ç­›é€‰ + åˆ†é¡µ + æ‰¹é‡æ“ä½œ

**ç›®æ ‡ï¼š** ä¸ºèˆ±ä½åˆ—è¡¨æä¾›æŒ‰é‚®è½®/èˆªçº¿/èˆ±å‹ç­›é€‰ã€åˆ†é¡µã€æœç´¢ã€æ‰¹é‡ä¸Šä¸‹æ¶èƒ½åŠ›ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/repository.go`
- Modify: `backend/internal/repository/cabin_repo.go`
- å¯¹åº” `_test.go`

**RED**

```go
func TestCabinSKURepository_ListWithFilters(t *testing.T) {
    db, _ := gorm.Open(sqlite.Open(":memory:"), &gorm.Config{})
    db.AutoMigrate(&domain.CabinSKU{}, &domain.CabinInventory{})
    repo := NewCabinSKURepository(db)
    ctx := context.Background()

    repo.CreateSKU(ctx, &domain.CabinSKU{Code: "A101", VoyageID: 1, CabinTypeID: 1, Status: 1})
    repo.CreateSKU(ctx, &domain.CabinSKU{Code: "B201", VoyageID: 1, CabinTypeID: 2, Status: 0})

    filter := domain.CabinSKUFilter{VoyageID: 1, CabinTypeID: 1, Page: 1, PageSize: 10}
    items, total, err := repo.ListSKUFiltered(ctx, filter)
    if err != nil { t.Fatal(err) }
    if total != 1 { t.Fatalf("expected 1, got %d", total) }
    _ = items
}

func TestCabinSKURepository_BatchUpdateStatus(t *testing.T) {
    db, _ := gorm.Open(sqlite.Open(":memory:"), &gorm.Config{})
    db.AutoMigrate(&domain.CabinSKU{})
    repo := NewCabinSKURepository(db)
    ctx := context.Background()
    repo.CreateSKU(ctx, &domain.CabinSKU{Code: "X1", Status: 1})
    err := repo.BatchUpdateStatus(ctx, []int64{1}, 0)
    if err != nil { t.Fatal(err) }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

åœ¨ `domain/repository.go` æ·»åŠ ï¼š

```go
type CabinSKUFilter struct {
    VoyageID    int64
    CabinTypeID int64
    Status      int16
    Keyword     string // æ¨¡ç³Šæœç´¢ç¼–å·
    Page        int
    PageSize    int
}
```

æ‰©å±• `CabinSKURepository` æ¥å£:
```go
ListSKUFiltered(ctx context.Context, f CabinSKUFilter) ([]CabinSKU, int64, error)
BatchUpdateStatus(ctx context.Context, ids []int64, status int16) error
```

åœ¨ `cabin_repo.go` ä¸­å®ç°ã€‚

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add filtered listing and batch status for cabin SKU"`

---

### Task 11: åº“å­˜é¢„è­¦ + ä»·æ ¼çŸ©é˜µæ‰©å±•

**ç›®æ ‡ï¼š** å®ç°åº“å­˜é¢„è­¦é˜ˆå€¼åŠŸèƒ½å’Œå¤šç»´åº¦ä»·æ ¼çŸ©é˜µï¼ˆå„¿ç«¥ä»·ã€å•äººè¡¥å·®ã€èŠ‚å‡æ—¥åŠ ä»·ã€æ—©é¸Ÿä»·ï¼‰ã€‚

**Filesï¼š**
- Modify: `backend/internal/domain/cabin.go` â€” `CabinInventory` æ·»åŠ  `AlertThreshold` å­—æ®µï¼›`CabinPrice` æ·»åŠ  `PriceType` å­—æ®µ
- Create: `backend/internal/service/inventory_alert_service.go`
- å¯¹åº” `_test.go`

**RED**

```go
func TestInventoryAlert(t *testing.T) {
    inv := CabinInventory{Total: 10, Locked: 3, Sold: 5, AlertThreshold: 5}
    available := inv.Total - inv.Locked - inv.Sold
    if available >= inv.AlertThreshold { t.Fatal("expected alert triggered") }
}

func TestCabinPriceType(t *testing.T) {
    p := CabinPrice{PriceType: "child", PriceCents: 5000}
    if p.PriceType == "" { t.Fatal("expected price_type") }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

ä¿®æ”¹ `CabinInventory`ï¼šæ·»åŠ  `AlertThreshold int json:"alert_threshold"`ã€‚

ä¿®æ”¹ `CabinPrice`ï¼šæ·»åŠ  `PriceType string gorm:"size:20;default:base" json:"price_type"` â€” å¯é€‰å€¼ base/child/single_supplement/holiday/early_birdã€‚

åˆ›å»º `inventory_alert_service.go`ï¼š
- `CheckAlerts(ctx) ([]InventoryAlert, error)` â€” æŸ¥è¯¢æ‰€æœ‰ available < threshold çš„ SKU
- `SetThreshold(ctx, skuID, threshold) error`

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add inventory alerts and price type matrix"`

---

### Task 12: èˆ±ä½å•†å“ç®¡ç† Handler æ‰©å±•

**ç›®æ ‡ï¼š** æ›´æ–° CabinHandler æ”¯æŒé«˜çº§ç­›é€‰åˆ—è¡¨ã€æ‰¹é‡æ“ä½œã€åº“å­˜é¢„è­¦æŸ¥è¯¢ã€ä»·æ ¼ç±»å‹æ”¯æŒã€‚

**Filesï¼š**
- Modify: `backend/internal/handler/cabin_handler.go`
- Modify: `backend/internal/router/router.go`
- å¯¹åº” `_test.go`

**RED**

```go
func TestCabinHandler_FilteredList(t *testing.T) {
    gin.SetMode(gin.TestMode)
    r := gin.New()
    h := NewCabinHandler(newMockCabinSvc())
    r.GET("/api/v1/admin/cabins", h.FilteredList)
    w := httptest.NewRecorder()
    r.ServeHTTP(w, httptest.NewRequest("GET", "/api/v1/admin/cabins?voyage_id=1&cabin_type_id=2&page=1&page_size=10", nil))
    if w.Code != 200 { t.Fatalf("expected 200, got %d", w.Code) }
}

func TestCabinHandler_BatchStatus(t *testing.T) {
    gin.SetMode(gin.TestMode)
    r := gin.New()
    h := NewCabinHandler(newMockCabinSvc())
    r.PUT("/api/v1/admin/cabins/batch-status", h.BatchUpdateStatus)
    body := `{"ids":[1,2],"status":0}`
    w := httptest.NewRecorder()
    r.ServeHTTP(w, httptest.NewRequest("PUT", "/api/v1/admin/cabins/batch-status", strings.NewReader(body)))
    if w.Code != 200 { t.Fatalf("expected 200, got %d", w.Code) }
}
```

è¿è¡Œ â†’ FAIL

**GREEN**

åœ¨ `CabinHandler` æ–°å¢ï¼š
- `FilteredList` â€” è§£æ query å‚æ•°æ„é€  `CabinSKUFilter` è°ƒç”¨ service
- `BatchUpdateStatus` â€” æ‰¹é‡ä¸Šä¸‹æ¶
- `GetAlerts` â€” åº“å­˜é¢„è­¦åˆ—è¡¨ï¼ˆGET /admin/cabins/alertsï¼‰
- `SetAlertThreshold` â€” è®¾ç½®é¢„è­¦é˜ˆå€¼ï¼ˆPUT /admin/cabins/:id/alert-thresholdï¼‰

æ›´æ–° `CabinService` æ¥å£ï¼Œæ–°å¢å¯¹åº”æ–¹æ³•ç­¾åã€‚

æ›´æ–° `router.go` æ³¨å†Œæ–°è·¯ç”±ã€‚

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add cabin filtered list, batch ops, and alerts handlers"`

---

### Task 13: è¿ç§» â€” èˆ±ä½å•†å“ç®¡ç†æ‰©å±•å­—æ®µ

**Filesï¼š**
- Modify: `backend/migrations/000005_sprint41_extend.up.sql` â€” è¿½åŠ  cabin_skus å’Œ cabin_prices æ‰©å±•å­—æ®µ

åœ¨ Task 5 çš„è¿ç§»æ–‡ä»¶ä¸­è¿½åŠ ï¼š

```sql
-- CabinSKU æ‰©å±•
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS position VARCHAR(20);
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS orientation VARCHAR(20);
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS has_window BOOLEAN DEFAULT FALSE;
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS has_balcony BOOLEAN DEFAULT FALSE;
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS bed_type VARCHAR(100);
ALTER TABLE cabin_skus ADD COLUMN IF NOT EXISTS amenities TEXT;

-- CabinInventory æ‰©å±•
ALTER TABLE cabin_inventories ADD COLUMN IF NOT EXISTS alert_threshold INT DEFAULT 0;

-- CabinPrice æ‰©å±•
ALTER TABLE cabin_prices ADD COLUMN IF NOT EXISTS price_type VARCHAR(20) DEFAULT 'base';
```

è¿è¡Œè¿ç§»æµ‹è¯• â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add cabin SKU/inventory/price migration extensions"`

---

## å‰ç«¯è®¾è®¡è§„èŒƒï¼ˆä¸‰ç«¯å·®å¼‚åŒ–è®¾è®¡ï¼‰

> ä¸‰ä¸ªå‰ç«¯äº§å“é¢å‘ä¸åŒç”¨æˆ·ç¾¤ä½“å’Œä½¿ç”¨åœºæ™¯ï¼Œ**å¿…é¡»**é‡‡ç”¨å·®å¼‚åŒ–çš„è§†è§‰è®¾è®¡è¯­è¨€ã€‚ä½† Web å‰å°å’Œå°ç¨‹åºå‰å°é¢å‘ç»ˆç«¯ç”¨æˆ·æ—¶ï¼Œå±•ç¤ºçš„**ä¸šåŠ¡æ•°æ®å†…å®¹**ï¼ˆé‚®è½®ä¿¡æ¯ã€èˆ±ä½ä¿¡æ¯ã€ä»·æ ¼ã€åº“å­˜ç­‰ï¼‰å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œä»…åœ¨è§†è§‰é£æ ¼å’Œäº¤äº’æ¨¡å¼ä¸Šæœ‰æ‰€åŒºåˆ†ã€‚

### Admin ç®¡ç†åå° â€” ä¸“ä¸šæ•°æ®é©±åŠ¨å‹è®¾è®¡

**è®¾è®¡ç†å¿µï¼š** ä¼ä¸šçº§ SaaS ç®¡ç†æ§åˆ¶å°ã€‚è¿½æ±‚é«˜ä¿¡æ¯å¯†åº¦ã€é«˜æ•ˆæ“ä½œã€ä½è§†è§‰å¹²æ‰°çš„ä¸“ä¸šå·¥å…·å‹é£æ ¼ã€‚å‚è€ƒ Linearã€Vercel Dashboardã€Stripe Dashboard çš„å…‹åˆ¶ä¼˜é›…ã€‚

**è‰²å½©ä½“ç³»ï¼š**
- ä¸»è‰²ï¼š`Indigo-600` (#4F46E5) â€” ç”¨äºä¸»æ“ä½œæŒ‰é’®ã€æ¿€æ´»æ€ã€é“¾æ¥
- èƒŒæ™¯è‰²ï¼š`Slate-50` (#F8FAFC) é¡µé¢åº•è‰² / `White` å¡ç‰‡/é¢æ¿åº•è‰²
- è¾¹æ¡†è‰²ï¼š`Slate-200` (#E2E8F0) â€” ç”¨äºå¡ç‰‡è¾¹æ¡†ã€åˆ†å‰²çº¿ã€è¡¨æ ¼è¾¹æ¡†
- æ–‡å­—è‰²ï¼š`Slate-900` (#0F172A) æ ‡é¢˜ / `Slate-600` (#475569) æ­£æ–‡ / `Slate-400` (#94A3B8) æ¬¡è¦ä¿¡æ¯
- çŠ¶æ€è‰²ï¼š`Emerald-500` ä¸Šæ¶/æˆåŠŸ / `Amber-500` ç»´æŠ¤ä¸­/è­¦å‘Š / `Rose-500` ä¸‹æ¶/é”™è¯¯ / `Sky-500` ä¿¡æ¯æç¤º

**æ’ç‰ˆï¼š**
- å­—ä½“ï¼š`Inter`ï¼ˆè‹±æ–‡ï¼‰ã€`Noto Sans SC`ï¼ˆä¸­æ–‡ï¼‰ï¼Œé€šè¿‡ Google Fonts å¼•å…¥
- æ ‡é¢˜ï¼š20px/600 â†’ 16px/600 â†’ 14px/600 ä¸‰çº§é€’å‡
- æ­£æ–‡ï¼š14px/400ï¼Œè¡Œé«˜ 1.6
- è¡¨æ ¼/æ•°æ®ï¼š13px/400 ç´§å‡‘æ’åˆ—

**æ ¸å¿ƒç»„ä»¶é£æ ¼ï¼š**
- **è¡¨æ ¼**ï¼šæ–‘é©¬çº¹(`Slate-50`äº¤æ›¿è¡Œ)ã€æ‚¬æµ®é«˜äº®(`Indigo-50`)ã€å›ºå®šè¡¨å¤´ã€åˆ—å®½å¯è°ƒèŠ‚
- **ç­›é€‰æ **ï¼šç´§å‡‘æ°´å¹³å¸ƒå±€ï¼Œæœç´¢æ¡† + ä¸‹æ‹‰ç­›é€‰ + æ“ä½œæŒ‰é’®åœ¨åŒä¸€è¡Œï¼ŒèƒŒæ™¯ç™½è‰²å¡ç‰‡ï¼Œ`border-radius: 8px`
- **è¡¨å•**ï¼šå‚ç›´æ ‡ç­¾å¸ƒå±€ï¼Œæ¯ä¸ªå­—æ®µç»„é—´è· `16px`ï¼Œæ ‡ç­¾ `Slate-600 13px/500`ï¼Œè¾“å…¥æ¡†é«˜åº¦ `38px`ï¼Œèšç„¦æ—¶ `ring-2 ring-Indigo-500`
- **çŠ¶æ€æ ‡ç­¾**ï¼šåœ†è§’è¯ä¸¸ `rounded-full px-2.5 py-0.5 text-xs font-medium`ï¼Œé¢œè‰²å¯¹åº”çŠ¶æ€è‰²æµ…åº•+æ·±æ–‡å­—ï¼ˆå¦‚ä¸Šæ¶=`bg-emerald-50 text-emerald-700`ï¼‰
- **æ‰¹é‡æ“ä½œæ **ï¼šé€‰ä¸­è¡Œååº•éƒ¨æµ®å‡ºæ“ä½œæ¡ï¼ˆ`fixed bottom-0`ï¼‰ï¼Œ`bg-Indigo-600 text-white`ï¼Œæ˜¾ç¤ºé€‰ä¸­æ•°é‡å’Œå¯ç”¨æ“ä½œ
- **æ•°æ®å¡ç‰‡ï¼ˆDashboardï¼‰**ï¼šç™½åº•åœ†è§’å¡ç‰‡ `shadow-sm border`ï¼Œå†…å«æ ‡é¢˜ã€æ•°å€¼ï¼ˆ`text-2xl font-bold`ï¼‰ã€è¶‹åŠ¿ç®­å¤´
- **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŒºåŸŸ**ï¼šç™½åº•ã€`min-height: 300px`ã€å·¥å…·æ  `bg-Slate-50` ç½®é¡¶ã€`border rounded-lg`
- **å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ**ï¼šè™šçº¿è¾¹æ¡† `border-dashed border-2 border-Slate-300`ï¼Œæ‹–æ‹½çƒ­åŒºã€ç¼©ç•¥å›¾ç½‘æ ¼ `gap-3`ï¼Œä¸»å›¾è§’æ ‡ `bg-Indigo-600 text-white text-xs`

**åŠ¨æ•ˆï¼š** æç®€è¿‡æ¸¡ `transition-all duration-150`ï¼Œä»…ç”¨äº hoverã€focusã€å±•å¼€æŠ˜å ã€‚ç¦æ­¢èŠ±å“¨åŠ¨ç”»ã€‚

---

### Web å‰å° â€” æ²‰æµ¸å¼æ—…è¡Œæ‚å¿—é£æ ¼

**è®¾è®¡ç†å¿µï¼š** é«˜ç«¯é‚®è½®æ—…è¡Œå“ç‰Œå®˜ç½‘ã€‚è¿½æ±‚å¤§å›¾æ²‰æµ¸ã€è§†è§‰å†²å‡»åŠ›ã€æƒ…æ„ŸåŒ–è®¾è®¡ï¼Œæ¿€å‘ç”¨æˆ·å¯¹é‚®è½®æ—…è¡Œçš„å‘å¾€ã€‚å‚è€ƒ Viking Cruisesã€Silverseaã€Regent Seven Seas ç­‰é«˜ç«¯é‚®è½®å®˜ç½‘è®¾è®¡ï¼Œä»¥åŠ Airbnb Luxe çš„å“è´¨æ„Ÿã€‚

**è‰²å½©ä½“ç³»ï¼š**
- ä¸»è‰²ï¼šæ·±æµ·è“ `#0C2340` â€” ç”¨äº Headerã€Footerã€CTA æŒ‰é’®åº•è‰²
- å¼ºè°ƒè‰²ï¼šæš–é‡‘ `#C9A96E` â€” ç”¨äºä»·æ ¼å±•ç¤ºã€é«˜äº®æ ‡ç­¾ã€æ˜Ÿçº§è¯„åˆ†ã€åˆ†å‰²çº¿ç‚¹ç¼€
- èƒŒæ™¯è‰²ï¼š`#FAFBFC`ï¼ˆææµ…ç°ç™½ï¼‰é¡µé¢åº•è‰² / `#FFFFFF` å†…å®¹å¡ç‰‡
- è¾…åŠ©è‰²ï¼šæµ·æ´‹ç»¿ `#2A9D8F` ç”¨äº"å¯é¢„è®¢"æ ‡ç­¾å’Œæ­£å‘æ“ä½œ
- æ–‡å­—è‰²ï¼š`#1A1A2E` æ ‡é¢˜ / `#4A4A68` æ­£æ–‡ / `#8E8EA0` è¾…åŠ©è¯´æ˜
- æ¸å˜è‰²ï¼ˆç”¨äº Hero åŒºåŸŸå åŠ å±‚ï¼‰ï¼š`linear-gradient(180deg, rgba(12,35,64,0) 0%, rgba(12,35,64,0.85) 100%)`

**æ’ç‰ˆï¼š**
- æ ‡é¢˜å­—ä½“ï¼š`Playfair Display`ï¼ˆè¡¬çº¿ä½“ï¼Œä¼ é€’å¥¢åè´¨æ„Ÿï¼‰
- æ­£æ–‡å­—ä½“ï¼š`Inter`ï¼ˆæ— è¡¬çº¿ï¼Œä¿è¯å¯è¯»æ€§ï¼‰
- é‚®è½®åç§°ï¼š`32px/700 Playfair Display`ï¼Œå­—é—´è· `0.02em`
- æ­£æ–‡ï¼š16px/400 Interï¼Œè¡Œé«˜ 1.75
- ä»·æ ¼æ ‡æ³¨ï¼š`24px/700 Inter`ï¼Œé¢œè‰²æš–é‡‘

**æ ¸å¿ƒé¡µé¢é£æ ¼ï¼š**

**é‚®è½®åˆ—è¡¨é¡µï¼š**
- é¡¶éƒ¨ Hero Bannerï¼šå…¨å®½é«˜åº¦ `50vh`ï¼Œé‚®è½®å…¨æ™¯æµ·ä¸Šç…§ç‰‡ + åŠé€æ˜æ¸å˜è¦†ç›–å±‚ + å±…ä¸­æ ‡é¢˜ `Playfair Display text-white text-5xl`
- æœç´¢æ ï¼šæ‚¬æµ®åœ¨ Hero åº•éƒ¨ `-mt-8`ï¼Œç™½è‰²åœ†è§’å¡ç‰‡ `shadow-xl rounded-2xl`ï¼Œå†…å«ç›®çš„åœ°/æ—¥æœŸ/äººæ•°ç­›é€‰
- é‚®è½®å¡ç‰‡ç½‘æ ¼ï¼š`grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8`
- æ¯å¼ å¡ç‰‡ï¼šå°é¢å›¾é¡¶éƒ¨ `aspect-[4/3] rounded-t-xl overflow-hidden`ï¼Œå›¾ç‰‡ `hover:scale-105 transition-transform duration-500`ï¼Œåº•éƒ¨ç™½è‰²ä¿¡æ¯åŒºå«é‚®è½®åï¼ˆ`Playfair Display`ï¼‰ã€å¨ä½/è½½å®¢é‡å°æ ‡ç­¾è¡Œã€"æŸ¥çœ‹è¯¦æƒ…"é“¾æ¥ï¼ˆæš–é‡‘è‰² + ç®­å¤´åŠ¨ç”»ï¼‰

**é‚®è½®è¯¦æƒ…é¡µï¼š**
- é¡¶éƒ¨å…¨å®½è½®æ’­ï¼šé«˜åº¦ `70vh`ï¼Œ`Swiper` ç»„ä»¶å¸¦åº•éƒ¨åœ†ç‚¹æŒ‡ç¤ºå™¨ + å·¦å³ç®­å¤´ï¼ˆæ‚¬æµ®åŠé€æ˜ç™½è‰²åœ†å½¢æŒ‰é’®ï¼‰
- åŸºæœ¬å‚æ•°åŒºï¼šä»¥å›¾æ ‡+æ•°å­—çš„å½¢å¼æ°´å¹³æ’åˆ—ï¼ˆå¦‚ âš“ 168,000å¨ | ğŸ‘¤ 6,780äºº | ğŸ› 2,200é—´ï¼‰ï¼Œä½¿ç”¨æš–é‡‘åˆ†éš”ç¬¦
- èˆ±æˆ¿ç±»å‹åŒºï¼šä½¿ç”¨ Accordionï¼ˆæ‰‹é£ç´æŠ˜å é¢æ¿ï¼‰ï¼Œæ”¶èµ·æ—¶æ˜¾ç¤ºä¸»å›¾ç¼©ç•¥+åç§°+é¢ç§¯+èµ·å§‹ä»·ï¼Œå±•å¼€åå¤§å›¾ç”»å»Š + å¯Œæ–‡æœ¬ä»‹ç» + è®¾æ–½æ¸…å•ï¼ˆicon gridï¼‰
- è®¾æ–½å¯¼è§ˆåŒºï¼šåˆ†ç±» Tab æ ä½¿ç”¨èƒ¶å›Šå¼æŒ‰é’®ï¼ˆ`rounded-full`ï¼‰ï¼Œæ¯ä¸ªè®¾æ–½ä¸ºæ¨ªå‘å¡ç‰‡ï¼ˆå·¦å›¾å³æ–‡ï¼‰ï¼Œå…è´¹æ ‡ç­¾ `bg-emerald-50 text-emerald-700`ï¼Œæ”¶è´¹æ ‡ç­¾ `bg-amber-50 text-amber-700`
- å…³è”èˆªçº¿åŒºï¼šæ—¶é—´è½´å¼å¸ƒå±€ï¼Œæ¯æ¡èˆªçº¿æ˜¾ç¤ºå‡ºå‘æ—¥æœŸ + å‡ºå‘æ¸¯ â†’ ç›®çš„æ¸¯ + æœ€ä½ä»·ï¼ˆæš–é‡‘å¤§å­—ï¼‰

**èˆ±ä½è¯¦æƒ…é¡µï¼š**
- å·¦ä¾§å¤§å›¾+å³ä¾§ä¿¡æ¯çš„åŒæ å¸ƒå±€ï¼ˆæ¡Œé¢ç«¯ï¼‰
- å±æ€§æ ‡ç­¾äº‘ï¼š`åºŠå‹` `é˜³å°` `æµ·æ™¯` ç­‰ä»¥èƒ¶å›Šæ ‡ç­¾å±•ç¤ºï¼ˆ`bg-blue-50 text-blue-700 rounded-full`ï¼‰
- ä»·æ ¼æ—¥å†ï¼šç½‘æ ¼å¡ç‰‡å½¢å¼ï¼Œæ¯æ—¥ä¸€æ ¼ï¼Œä½ä»·æ—¥ç»¿è‰²ã€å¸¸è§„æ—¥ç°ç™½ã€é«˜ä»·æ—¥æ©™è‰²ã€ä¸å¯ç”¨æ—¥ç°è‰²ç¦ç”¨æ€
- åº“å­˜çŠ¶æ€ï¼šè¿›åº¦æ¡å¯è§†åŒ–ï¼ˆç»¿è‰² > 50%ã€æ©™è‰² 20-50%ã€çº¢è‰² < 20%ï¼‰ï¼Œæ–‡å­—æ ‡ç­¾"å……è¶³/ç´§å¼ /å³å°†å”®ç½„"
- åº•éƒ¨å›ºå®š CTA æ ï¼š`position: sticky bottom-0`ï¼Œæ·±æµ·è“èƒŒæ™¯ï¼Œç™½è‰²"ç«‹å³é¢„è®¢"å¤§æŒ‰é’® + ä»·æ ¼

**åŠ¨æ•ˆï¼š**
- é¡µé¢æ»šåŠ¨è§†å·®æ•ˆæœï¼ˆHero å›¾ç‰‡ `background-attachment: fixed`ï¼‰
- å¡ç‰‡å…¥åœºåŠ¨ç”» `fade-up`ï¼ˆä½¿ç”¨ @vueuse/motion `v-motion` æŒ‡ä»¤ï¼‰ï¼Œäº¤é”™ `delay: index * 100ms`
- å›¾ç‰‡ç”»å»Šåˆ‡æ¢ `fade` è¿‡æ¸¡ `600ms ease`
- æŒ‰é’® hoverï¼š`transform: translateY(-2px)` + `shadow-lg` æå‡
- æ•°å­—æ»šåŠ¨åŠ¨æ•ˆï¼ˆå¨ä½ã€è½½å®¢é‡ç­‰ä½¿ç”¨ `CountUp` æ•ˆæœï¼‰

**å“åº”å¼æ–­ç‚¹ï¼š** `sm: 640px` / `md: 768px` / `lg: 1024px` / `xl: 1280px`ã€‚ç§»åŠ¨ç«¯é‚®è½®å¡ç‰‡æ”¹ä¸ºå•åˆ—ç«–å‘æ»‘åŠ¨ï¼Œè¯¦æƒ…é¡µæ”¹ä¸ºå•æ ã€‚

---

### Miniapp å°ç¨‹åº â€” åŸç”Ÿå¾®ä¿¡è®¾è®¡è¯­è¨€

**è®¾è®¡ç†å¿µï¼š** å¾®ä¿¡ç”Ÿæ€åŸç”Ÿä½“éªŒã€‚è¿½æ±‚è½»é‡ã€ç´§å‡‘ã€æ‰‹æŒ‡å‹å¥½ï¼Œéµå¾ªå¾®ä¿¡è®¾è®¡è§„èŒƒçš„åŒæ—¶èå…¥æ—…è¡Œä¸»é¢˜çš„æ¸©æš–è‰²è°ƒã€‚å‚è€ƒæºç¨‹/é£çŒªå°ç¨‹åºçš„ä¿¡æ¯å¯†åº¦ + é«˜ç«¯é…’åº—å°ç¨‹åºçš„å“è´¨æ„Ÿã€‚

**è‰²å½©ä½“ç³»ï¼š**
- ä¸»è‰²ï¼šçŠç‘šæ©˜ `#FF6B6B` â€” ç”¨äºä»·æ ¼é«˜äº®ã€CTA æŒ‰é’®ã€é‡ç‚¹æ ‡ç­¾
- è¾…åŠ©è‰²ï¼šæ¸…è¿œé’ `#26A69A` â€” ç”¨äº"å¯ç”¨"çŠ¶æ€ã€æˆåŠŸæç¤ºã€æ¬¡è¦æ“ä½œ
- èƒŒæ™¯è‰²ï¼š`#F5F5F5`ï¼ˆå¾®ä¿¡ç°ï¼‰é¡µé¢åº•è‰² / `#FFFFFF` å¡ç‰‡åº•è‰²
- åˆ†å‰²çº¿ï¼š`#EEEEEE`
- æ–‡å­—è‰²ï¼š`#333333` æ ‡é¢˜ / `#666666` æ­£æ–‡ / `#999999` è¾…åŠ© / `#FF6B6B` ä»·æ ¼

**æ’ç‰ˆï¼š**
- å­—ä½“ï¼šç³»ç»Ÿé»˜è®¤ï¼ˆ-apple-system, 'PingFang SC'ï¼‰ï¼Œä¸å¤–éƒ¨å¼•å…¥å­—ä½“ï¼ˆå°ç¨‹åºåŒ…å¤§å°é™åˆ¶ï¼‰
- æ ‡é¢˜ï¼š`36rpx/bold`
- æ­£æ–‡ï¼š`28rpx/normal`
- è¾…åŠ©æ–‡å­—ï¼š`24rpx/normal color: #999`
- ä»·æ ¼æ•°å­—ï¼š`40rpx/bold color: #FF6B6B`ï¼Œ"Â¥"ç¬¦å· `24rpx`

**æ ¸å¿ƒé¡µé¢é£æ ¼ï¼š**

**é‚®è½®åˆ—è¡¨é¡µï¼š**
- é¡¶éƒ¨æœç´¢æ ï¼šå›ºå®šé¡¶éƒ¨ `position: fixed`ï¼Œç™½è‰²èƒŒæ™¯ + åœ†è§’æœç´¢æ¡† `border-radius: 32rpx; background: #F5F5F5`
- é‚®è½®å¡ç‰‡ï¼šç«–å‘åˆ—è¡¨æ»šåŠ¨ï¼Œæ¯å¼ å¡ç‰‡ `margin: 16rpx 24rpx`ï¼Œç™½è‰²åœ†è§’ `border-radius: 16rpx`ï¼Œ`box-shadow: 0 2rpx 12rpx rgba(0,0,0,0.06)`
- å¡ç‰‡å†…éƒ¨ï¼šé¡¶éƒ¨å°é¢å›¾ `height: 320rpx; border-radius: 16rpx 16rpx 0 0`ï¼Œåº•éƒ¨ `padding: 20rpx 24rpx`
- ä¿¡æ¯è¡Œï¼šé‚®è½®åï¼ˆ`font-size: 32rpx; font-weight: bold`ï¼‰ã€ç°è‰²å‚æ•°è¡Œï¼ˆå¨ä½ Â· è½½å®¢é‡ Â· èˆ±å‹Nç§ï¼‰ï¼Œåº•éƒ¨"æŸ¥çœ‹è¯¦æƒ… >"æ–‡å­—é“¾ï¼ˆçŠç‘šæ©˜è‰²ï¼‰

**é‚®è½®è¯¦æƒ…é¡µï¼š**
- é¡¶éƒ¨ Swiper è½®æ’­ï¼šé«˜åº¦ `480rpx`ï¼Œåœ†ç‚¹æŒ‡ç¤ºå™¨å±…åº•éƒ¨ä¸­å¤®
- å‚æ•°åŒºï¼šæ°´å¹³æ»šåŠ¨çš„å°å¡ç‰‡æ¡ `scroll-view direction="horizontal"`ï¼Œæ¯ä¸ªå‚æ•°ä¸ºç‹¬ç«‹å°å¡ç‰‡ï¼ˆå›¾æ ‡ + æ•°å€¼ + æ ‡ç­¾ï¼‰ï¼Œ`width: 140rpx; background: #F8F9FA; border-radius: 12rpx`
- èˆ±æˆ¿ç±»å‹åŒºï¼šæ ‡é¢˜è¡Œ"èˆ±æˆ¿ç±»å‹"+ å³ä¾§"å…¨éƒ¨ >"ï¼Œåˆ—è¡¨æ¯é¡¹å«å·¦ä¾§å°å›¾ `100rpx * 100rpx rounded-12rpx`ï¼Œä¸­é—´åç§°+é¢ç§¯+äººæ•°ï¼Œå³ä¾§èµ·å§‹ä»·ï¼ˆçŠç‘šæ©˜å¤§å­—ï¼‰ï¼Œç‚¹å‡»å±•å¼€å¤§å›¾ç”»å»Š + æè¿°
- è®¾æ–½å¯¼è§ˆï¼šæ¨ªå‘åˆ†ç±»æ ‡ç­¾æ»šåŠ¨æ¡ï¼ˆ`scroll-view`ï¼‰ï¼Œé€‰ä¸­æ€ `border-bottom: 4rpx solid #FF6B6B`ï¼Œä¸‹æ–¹è®¾æ–½ç½‘æ ¼ï¼ˆ2åˆ—ï¼Œæ¯æ ¼å«å›¾ç‰‡+åç§°+ä½ç½®/æ”¶è´¹æ ‡è¯†ï¼‰
- å…³è”èˆªçº¿ï¼šåˆ—è¡¨å¡ç‰‡å½¢å¼ï¼Œæ¯æ¡èˆªçº¿å«å‡ºå‘æ—¥æœŸå¾½ç«  `bg-Coral-50 rounded-8rpx`ã€èˆªçº¿åã€æœ€ä½ä»·
- åº•éƒ¨å®‰å…¨åŒºæ“ä½œæ ï¼š`padding-bottom: env(safe-area-inset-bottom)`ï¼Œç™½è‰²èƒŒæ™¯ï¼Œå·¦ä¾§æ”¶è—/åˆ†äº«å›¾æ ‡ï¼Œå³ä¾§çŠç‘šæ©˜"æŸ¥çœ‹èˆªçº¿"æŒ‰é’® `border-radius: 44rpx; height: 88rpx`

**èˆ±ä½è¯¦æƒ…é¡µï¼š**
- Swiper å¤§å›¾ + åº•éƒ¨ `N/M` é¡µç 
- ä»·æ ¼åŒºï¼šæ•´è¡ŒçŠç‘šæ©˜è‰² `Â¥1,280èµ·`ï¼Œå³ä¾§ç°è‰²"å«ç¨è´¹"
- å±æ€§æ ‡ç­¾ï¼šåœ†è§’çŸ©å½¢æ ‡ç­¾æµ `display: flex; flex-wrap: wrap; gap: 12rpx`ï¼Œæ¯ä¸ªæ ‡ç­¾ `background: #F0F7FF; color: #4A90D9; border-radius: 8rpx; padding: 8rpx 16rpx; font-size: 24rpx`
- è®¾æ–½æ¸…å•ï¼šä¸¤åˆ—å›¾æ ‡ç½‘æ ¼ `grid-template-columns: repeat(2, 1fr)`ï¼Œæ¯é¡¹å« âœ“ å›¾æ ‡ + è®¾æ–½å
- ä»·æ ¼æ—¥å†ï¼šæ°´å¹³æ»‘åŠ¨æ—¥æœŸæ¡ + å½“å‰é€‰ä¸­æ—¥è¯¦ç»†ä»·æ ¼é¢æ¿ï¼ˆåŸºç¡€ä»·/å„¿ç«¥ä»·ä¸€ç›®äº†ç„¶ï¼‰
- åº“å­˜æŒ‡ç¤ºï¼šæ–‡å­—æ ‡ç­¾å¼ï¼ˆ"ä»…å‰©3é—´"çº¢è‰²é—ªçƒ / "å……è¶³"ç»¿è‰²ï¼‰ï¼Œä¸ç”¨è¿›åº¦æ¡ï¼ˆå°ç¨‹åºå±å¹•çª„ï¼‰
- åº•éƒ¨æ“ä½œæ ï¼šå·¦ä¾§å®¢æœå›¾æ ‡ã€å³ä¾§"ç«‹å³é¢„è®¢"æŒ‰é’®ï¼ˆåŒä¸Šåœ†è§’å¤§æŒ‰é’®ï¼‰

**åŠ¨æ•ˆï¼š** æç®€ï¼Œä»…ä½¿ç”¨å¾®ä¿¡æ¨èçš„ `wx.createAnimation` æˆ– CSS `transition`ã€‚åˆ—è¡¨ä½¿ç”¨ `skeleton` éª¨æ¶å±åŠ è½½æ€ã€‚

**å°ç¨‹åºç‰¹æœ‰è§„èŒƒï¼š** å•ä½å…¨éƒ¨ä½¿ç”¨ `rpx`ï¼Œç¦æ­¢ `px`ã€‚å›¾ç‰‡ä½¿ç”¨ `<image mode="aspectFill">`ã€‚é•¿åˆ—è¡¨ä½¿ç”¨ `<scroll-view>` æˆ–è™šæ‹Ÿåˆ—è¡¨ã€‚æ‰€æœ‰è§¦æ§ç›®æ ‡æœ€å° `88rpx * 88rpx`ã€‚

---

### C ç«¯å†…å®¹ä¸€è‡´æ€§çº¦æŸ

> **Web å‰å°å’Œå°ç¨‹åºå‰å°å¿…é¡»å±•ç¤ºå®Œå…¨ä¸€è‡´çš„ä¸šåŠ¡æ•°æ®**ï¼Œå·®å¼‚ä»…åœ¨è§†è§‰å‘ˆç°ï¼š

| å†…å®¹é¡¹ | Web å‘ˆç°æ–¹å¼ | å°ç¨‹åºå‘ˆç°æ–¹å¼ | æ•°æ®æ¥æºï¼ˆåŒä¸€ APIï¼‰ |
|--------|-------------|---------------|---------------------|
| é‚®è½®å°é¢å›¾ | 4:3 å¤§å¡ç‰‡ hover æ”¾å¤§ | 320rpx é«˜åº¦å¡ç‰‡å›¾ | `GET /api/v1/cruises` + Image API |
| åŸºæœ¬å‚æ•° | å›¾æ ‡+æ•°å­—æ°´å¹³è¡Œ | æ°´å¹³æ»šåŠ¨å°å¡ç‰‡æ¡ | åŒä¸€ Cruise å¯¹è±¡ |
| èˆ±æˆ¿ç±»å‹ | Accordion æŠ˜å é¢æ¿ | åˆ—è¡¨é¡¹ç‚¹å‡»å±•å¼€ | `GET /api/v1/cabin-types?cruise_id=` |
| è®¾æ–½å¯¼è§ˆ | Tab åˆ‡æ¢ + æ¨ªå‘å¡ç‰‡ | æ¨ªå‘æ ‡ç­¾ + ç½‘æ ¼ | `GET /api/v1/facilities?cruise_id=` |
| èˆ±ä½ä»·æ ¼ | ä»·æ ¼æ—¥å†ç½‘æ ¼ | æ°´å¹³æ»‘åŠ¨æ—¥æœŸæ¡ | `GET /api/v1/cabins/:id/prices` |
| åº“å­˜çŠ¶æ€ | è¿›åº¦æ¡ + æ–‡å­—æ ‡ç­¾ | æ–‡å­—æ ‡ç­¾ + é¢œè‰² | CabinInventory æ•°æ® |
| å…³è”èˆªçº¿ | æ—¶é—´è½´å¸ƒå±€ | åˆ—è¡¨å¡ç‰‡ | `GET /api/v1/voyages?cruise_id=` |

---

## Part C: å‰ç«¯ç®¡ç†åå° (Tasks 14-17)

> æ‰€æœ‰ Vue ç»„ä»¶å¿…é¡»ä½¿ç”¨ `<script setup lang="ts">`ã€‚éµå¾ªä¸Šè¿° **Admin ç®¡ç†åå°** è®¾è®¡è§„èŒƒã€‚

### Task 14: Admin â€” é‚®è½®ç®¡ç†é¡µé¢å¢å¼º

**ç›®æ ‡ï¼š** æ›´æ–°é‚®è½®åˆ—è¡¨é¡µå’Œç¼–è¾‘é¡µï¼Œæ”¯æŒå…¨å­—æ®µ CRUDã€ç­›é€‰æ’åºã€æ‰¹é‡ä¸Šä¸‹æ¶ã€‚

**Filesï¼š**
- Modify: `frontend/admin/app/pages/cruises/index.vue` â€” æ·»åŠ åç§°/çŠ¶æ€ç­›é€‰ã€æ‰¹é‡æ“ä½œ
- Modify: `frontend/admin/app/pages/cruises/create.vue` â€” è¡¨å•å¢åŠ å…¨éƒ¨å­—æ®µ
- Modify: `frontend/admin/app/pages/cruises/[id].vue` â€” ç¼–è¾‘é¡µå®Œå–„
- Modify: `frontend/admin/tests/unit/pages/cruises-index.spec.ts`

**RED**

```ts
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import Page from '../../../app/pages/cruises/index.vue'

describe('Cruise list enhanced', () => {
  it('renders filter controls', () => {
    const wrapper = mount(Page)
    expect(wrapper.find('[data-test="filter-keyword"]').exists()).toBe(true)
    expect(wrapper.find('[data-test="filter-status"]').exists()).toBe(true)
    expect(wrapper.find('[data-test="batch-action"]').exists()).toBe(true)
  })
})
```

è¿è¡Œ â†’ FAIL

**GREEN**

æ›´æ–° `cruises/index.vue`ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼š
- é¡µé¢èƒŒæ™¯ `bg-Slate-50`ï¼Œå†…å®¹åŒºç™½è‰²å¡ç‰‡ `shadow-sm border border-Slate-200 rounded-lg`
- é¡¶éƒ¨ç­›é€‰æ ï¼šæ°´å¹³ç´§å‡‘å¸ƒå±€ï¼Œæœç´¢æ¡†ï¼ˆ`ring-Indigo-500` èšç„¦æ€ï¼‰+ çŠ¶æ€ä¸‹æ‹‰ï¼ˆä¸Šæ¶/ä¸‹æ¶/ç»´æŠ¤ä¸­/å…¨éƒ¨ï¼‰+ å¨ä½æ’åºæŒ‰é’®ï¼ŒåŒè¡Œæ’åˆ—
- è¡¨æ ¼ï¼šæ–‘é©¬çº¹ï¼ˆ`Slate-50` äº¤æ›¿è¡Œï¼‰ã€æ‚¬æµ®é«˜äº®ï¼ˆ`Indigo-50`ï¼‰ï¼Œåˆ—ï¼šåç§°ã€ä»£ç ã€å…¬å¸ã€å¨ä½ã€è½½å®¢é‡ã€çŠ¶æ€æ ‡ç­¾ï¼ˆåœ†è§’è¯ä¸¸ï¼Œé¢œè‰²æŒ‰çŠ¶æ€åŒºåˆ†ï¼‰ã€æ“ä½œæŒ‰é’®
- æ‰¹é‡é€‰ä¸­ååº•éƒ¨æµ®å‡ºæ“ä½œæ¡ï¼ˆ`fixed bottom-0 bg-Indigo-600 text-white`ï¼‰ï¼Œæ˜¾ç¤º"å·²é€‰ N é¡¹"+ æ‰¹é‡ä¸Šæ¶/ä¸‹æ¶æŒ‰é’®
- åˆ†é¡µç»„ä»¶å±…åº•éƒ¨å³ä¾§

æ›´æ–° `cruises/create.vue` å’Œ `cruises/[id].vue`ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼š
- è¡¨å•ä»¥ç™½è‰²å¡ç‰‡æ‰¿è½½ï¼Œå‚ç›´æ ‡ç­¾å¸ƒå±€ï¼Œå­—æ®µç»„é—´è· `16px`
- æ ‡ç­¾ `Slate-600 13px/500`ï¼Œè¾“å…¥æ¡†é«˜åº¦ `38px`ï¼Œèšç„¦ `ring-2 ring-Indigo-500`
- è¡¨å•å­—æ®µï¼šåç§°ã€è‹±æ–‡åã€ä»£ç ã€å…¬å¸ï¼ˆä¸‹æ‹‰ï¼‰ã€å¨ä½ã€è½½å®¢é‡ã€èˆ¹å‘˜æ•°ã€å»ºé€ å¹´ä»½ã€ç¿»æ–°å¹´ä»½ã€é•¿åº¦ã€å®½åº¦ã€ç”²æ¿æ•°ã€æè¿°ï¼ˆTipTap å¯Œæ–‡æœ¬åŒºï¼Œ`bg-Slate-50` å·¥å…·æ ã€`min-height: 300px`ï¼‰ã€æ’åºã€çŠ¶æ€ï¼ˆä¸‰é€‰å•é€‰æŒ‰é’®ç»„ï¼‰
- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸï¼šè™šçº¿è¾¹æ¡† `border-dashed border-2 border-Slate-300` æ‹–æ‹½çƒ­åŒºï¼Œç¼©ç•¥å›¾ç½‘æ ¼ `gap-3`ï¼Œæ‹–æ‹½æ’åºï¼Œä¸»å›¾è§’æ ‡ `bg-Indigo-600 text-white text-xs rounded`

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: enhance admin cruise pages with full fields and batch ops"`

---

### Task 15: Admin â€” èˆ±æˆ¿ç±»å‹ç®¡ç†é¡µé¢

**ç›®æ ‡ï¼š** å®Œå–„èˆ±æˆ¿ç±»å‹çš„åˆ—è¡¨+ç¼–è¾‘é¡µé¢ï¼Œæ‰€æœ‰ Specify A.2 å­—æ®µå¯è§†åŒ–ç¼–è¾‘ã€‚

**Filesï¼š**
- Create: `frontend/admin/app/pages/cabin-types/index.vue` â€” æŒ‰é‚®è½®ç­›é€‰çš„åˆ—è¡¨
- Create: `frontend/admin/app/pages/cabin-types/[id].vue` â€” ç¼–è¾‘é¡µ
- Create: `frontend/admin/app/pages/cabin-types/new.vue` â€” æ–°å»ºé¡µ
- Create: `frontend/admin/tests/unit/pages/cabin-types.spec.ts`

**RED**

```ts
describe('CabinType list', () => {
  it('renders cruise filter and table', () => {
    const wrapper = mount(Page)
    expect(wrapper.find('[data-test="cruise-filter"]').exists()).toBe(true)
    expect(wrapper.find('table').exists()).toBe(true)
  })
})
```

è¿è¡Œ â†’ FAIL

**GREEN**

å®ç°å®Œæ•´çš„èˆ±æˆ¿ç±»å‹ç®¡ç†ä¸‰é¡µé¢ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼š
- åˆ—è¡¨é¡µï¼šé¡µé¢æ ‡é¢˜ `text-xl font-semibold Slate-900`ï¼Œé‚®è½®ä¸‹æ‹‰ç­›é€‰ + è¡¨æ ¼ï¼ˆæ–‘é©¬çº¹äº¤æ›¿è¡Œï¼‰ï¼Œåˆ—å«åç§°ã€ä»£ç ã€é¢ç§¯èŒƒå›´ã€å®¹é‡ã€çŠ¶æ€è¯ä¸¸æ ‡ç­¾ã€æ“ä½œ
- æ–°å»º/ç¼–è¾‘é¡µï¼šç™½è‰²å¡ç‰‡è¡¨å•ï¼Œåˆ†åŒºæ ‡é¢˜ï¼ˆåŸºæœ¬ä¿¡æ¯ / é¢ç§¯ä¸å®¹é‡ / åºŠå‹ä¸è®¾æ–½ / å›¾ç‰‡ä¸ä»‹ç»ï¼‰ä»¥ `border-b Slate-200` åˆ†éš”ï¼›ç‰¹è‰²æ ‡ç­¾ä½¿ç”¨å¤šé€‰ Checkbox ç½‘æ ¼ï¼ˆ`grid-cols-3`ï¼‰ï¼›è®¾æ–½æ¸…å•ä½¿ç”¨ Checkbox ä¸¤åˆ—å¸ƒå±€ï¼›å›¾ç‰‡ç”»å»Šä¸Šä¼ åŒ Cruise è§„èŒƒï¼ˆè™šçº¿æ¡†+ç¼©ç•¥å›¾ç½‘æ ¼+ä¸»å›¾è§’æ ‡ï¼‰ï¼›å¹³é¢å›¾å•ç‹¬ä¸Šä¼ åŒº

è¿è¡Œ â†’ PASS

**æäº¤ï¼š** `git commit -m "feat: add admin cabin-type management pages"`

---

### Task 16: Admin â€” è®¾æ–½ç®¡ç†é¡µé¢å®Œå–„

**ç›®æ ‡ï¼š** å®Œå–„è®¾æ–½åˆ†ç±»+è®¾æ–½ç®¡ç†ï¼Œæ”¯æŒ Specify A.3 å…¨éƒ¨åŠŸèƒ½ã€‚

**Filesï¼š**
- Create: `frontend/admin/app/pages/facility-categories/index.vue`
- Create: `frontend/admin/app/pages/facility-categories/[id].vue`
- Modify: `frontend/admin/app/pages/facilities/index.vue`ï¼ˆè‹¥æ— åˆ™åˆ›å»ºï¼‰
- Create: `frontend/admin/app/pages/facilities/[id].vue`
- Create: `frontend/admin/app/pages/facilities/new.vue`
- å¯¹åº”æµ‹è¯•

**RED â†’ GREEN â†’ REFACTOR**

è®¾æ–½åˆ†ç±»é¡µé¢ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼šåç§°ã€å›¾æ ‡é€‰æ‹©å™¨ï¼ˆå›¾æ ‡ç½‘æ ¼å¼¹çª—ï¼‰ã€æ’åºã€CRUDï¼Œç´§å‡‘è¡¨æ ¼+è¡Œå†…ç¼–è¾‘ã€‚
è®¾æ–½é¡µé¢ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼šé‚®è½®+åˆ†ç±»åŒä¸‹æ‹‰è”åŠ¨ç­›é€‰ï¼Œè¡¨æ ¼å«åç§°/ä½ç½®/å¼€æ”¾æ—¶é—´/æ”¶è´¹(âœ“/âœ—)/çŠ¶æ€æ ‡ç­¾/æ“ä½œï¼›æ–°å»º/ç¼–è¾‘å«å…¨å­—æ®µï¼Œ"æ˜¯å¦é¢å¤–æ”¶è´¹" Toggle å¼€å…³è”åŠ¨"æ”¶è´¹è¯´æ˜"è¾“å…¥æ¡†æ˜¾éšï¼Œé€‚åˆäººç¾¤æ ‡ç­¾å¤šé€‰ Checkbox è¡Œï¼Œ`Emerald-500` å…è´¹æ ‡ç­¾ / `Amber-500` æ”¶è´¹æ ‡ç­¾ã€‚

**æäº¤ï¼š** `git commit -m "feat: add admin facility management pages"`

---

### Task 17: Admin â€” èˆ±ä½å•†å“ç®¡ç†é¡µé¢å¢å¼º

**ç›®æ ‡ï¼š** å¢å¼ºèˆ±ä½åˆ—è¡¨é¡µï¼Œæ”¯æŒå¤šç»´ç­›é€‰ã€æ‰¹é‡æ“ä½œã€åº“å­˜é¢„è­¦ã€ä»·æ ¼çŸ©é˜µç¼–è¾‘ã€‚

**Filesï¼š**
- Modify: `frontend/admin/app/pages/cabins/index.vue`
- Modify: `frontend/admin/app/pages/cabins/[id].vue`
- Modify: `frontend/admin/app/pages/cabins/inventory.vue`
- Modify: `frontend/admin/app/pages/cabins/pricing.vue`
- Create: `frontend/admin/app/pages/cabins/alerts.vue` â€” åº“å­˜é¢„è­¦é¡µ
- å¯¹åº”æµ‹è¯•

**RED â†’ GREEN â†’ REFACTOR**

èˆ±ä½åˆ—è¡¨ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼šä¸‰çº§è”åŠ¨ä¸‹æ‹‰ï¼ˆé‚®è½®â†’èˆªçº¿â†’èˆ±å‹ï¼‰ï¼ŒåŒè¡Œæ°´å¹³å¸ƒå±€ + æœç´¢æ¡† + çŠ¶æ€ç­›é€‰ï¼›è¡¨æ ¼å«ç¼–å·ã€é‚®è½®ã€èˆªçº¿ã€èˆ±å‹ã€é¢ç§¯ã€ä»·æ ¼åŒºé—´ï¼ˆ`font-mono`ï¼‰ã€åº“å­˜ï¼ˆæ•°å­—+è¿·ä½ è¿›åº¦æ¡å†…åµŒï¼‰ã€çŠ¶æ€è¯ä¸¸æ ‡ç­¾ï¼›æ‰¹é‡é€‰ä¸­æµ®å‡ºæ“ä½œæ¡ã€‚

èˆ±ä½ç¼–è¾‘ï¼ˆéµå¾ª Admin è®¾è®¡è§„èŒƒï¼‰ï¼šåˆ†åŒºå¡ç‰‡ï¼ˆåŸºæœ¬ä¿¡æ¯ / ä½ç½®å±æ€§ / è®¾æ–½é…ç½®ï¼‰ï¼Œä½ç½®å’Œæœå‘ä½¿ç”¨ SegmentedControl é€‰æ‹©å™¨ï¼ˆfore/mid/aftã€port/starboardï¼‰ï¼Œçª—æˆ·/é˜³å°ä½¿ç”¨ Toggle å¼€å…³ï¼Œé™„å±è®¾æ–½ä½¿ç”¨ Checkbox ç½‘æ ¼ã€‚

åº“å­˜é¡µé¢ï¼šå››ä¸ªç»Ÿè®¡å¡ç‰‡æ¨ªæ’ï¼ˆæ€»é‡/é”å®š/å·²å”®/å¯ç”¨ï¼‰ï¼Œå¡ç‰‡å†…å« `text-2xl font-bold` å¤§æ•°å­— + è¶‹åŠ¿ç®­å¤´ï¼›é¢„è­¦é˜ˆå€¼å•ç‹¬è®¾ç½®è¡Œï¼ˆè¾“å…¥æ¡† + ä¿å­˜æŒ‰é’®ï¼‰ï¼›åº“å­˜å˜åŠ¨æ—¥å¿—è¡¨æ ¼ï¼ˆæ—¶é—´/å˜åŠ¨é‡/åŸå› ï¼‰ï¼Œå˜åŠ¨é‡æ­£æ•°ç»¿è‰²ã€è´Ÿæ•°çº¢è‰²ã€‚

ä»·æ ¼é¡µé¢ï¼šé¡¶éƒ¨ Tab æ åˆ‡æ¢ä»·æ ¼ç±»å‹ï¼ˆåŸºç¡€/å„¿ç«¥/å•äººè¡¥å·®/èŠ‚å‡æ—¥/æ—©é¸Ÿï¼‰ï¼Œ`border-bottom: 2px solid Indigo-600` æ¿€æ´»æ€ï¼›æ—¥å†ç½‘æ ¼å¯è§†åŒ–æ¯æ—¥ä»·æ ¼ï¼ˆ`grid-cols-7`ï¼Œæ•°å­—å±…ä¸­ï¼Œæœ‰å€¼ç»¿åº•/æ— å€¼ç°åº•ï¼‰ï¼Œé€‰ä¸­æ—¥é«˜äº® `ring-2 ring-Indigo-500`ï¼›åº•éƒ¨"æ‰¹é‡è®¾ä»·"å¼¹çª—ï¼ˆæ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ + ä»·æ ¼è¾“å…¥ï¼‰ã€‚

é¢„è­¦é¡µé¢ï¼šé¡¶éƒ¨é†’ç›®æ¨ªå¹… `bg-Rose-50 border-Rose-200`ï¼Œåˆ—å‡ºè§¦å‘é¢„è­¦çš„èˆ±ä½ï¼Œè¡¨æ ¼å«èˆ±ä½ç¼–å·/å¯ç”¨åº“å­˜ï¼ˆçº¢è‰²åŠ ç²—ï¼‰/é¢„è­¦é˜ˆå€¼/æ“ä½œã€‚

**æäº¤ï¼š** `git commit -m "feat: enhance admin cabin management with alerts and pricing matrix"`

---

## Part D: å‰ç«¯ â€” å‰å°å±•ç¤º (Tasks 18-20)

> Web å‰å°éµå¾ªä¸Šè¿° **Web å‰å° â€” æ²‰æµ¸å¼æ—…è¡Œæ‚å¿—é£æ ¼** è®¾è®¡è§„èŒƒã€‚å°ç¨‹åºéµå¾ª **Miniapp å°ç¨‹åº â€” åŸç”Ÿå¾®ä¿¡è®¾è®¡è¯­è¨€** è®¾è®¡è§„èŒƒã€‚ä¸¤ç«¯å±•ç¤ºçš„ä¸šåŠ¡æ•°æ®å†…å®¹å¿…é¡»å®Œå…¨ä¸€è‡´ã€‚

### Task 18: Web å‰å° â€” é‚®è½®åˆ—è¡¨ + è¯¦æƒ…é¡µ

**ç›®æ ‡ï¼š** å®ç° Specify A.4 çš„ Web å‰å°å±•ç¤ºã€‚

**Filesï¼š**
- Create: `frontend/web/app/pages/cruises/index.vue` â€” é‚®è½®åˆ—è¡¨ï¼ˆå¡ç‰‡å¼ï¼‰
- Create: `frontend/web/app/pages/cruises/[id].vue` â€” é‚®è½®è¯¦æƒ…é¡µ
- Create: `frontend/web/app/stores/cruise.ts`ï¼ˆè‹¥éœ€ä¿®æ”¹ï¼‰
- å¯¹åº”æµ‹è¯•

**RED â†’ GREEN â†’ REFACTOR**

é‚®è½®åˆ—è¡¨é¡µï¼ˆéµå¾ª Web æ²‰æµ¸å¼æ—…è¡Œæ‚å¿—é£æ ¼ï¼‰ï¼š
- é¡¶éƒ¨ Hero Banner å…¨å®½ `50vh`ï¼Œå¤§æµ·/é‚®è½®å…¨æ™¯å›¾ + æ¸å˜å åŠ å±‚ + `Playfair Display text-5xl text-white` å±…ä¸­æ ‡é¢˜
- æœç´¢æ æ‚¬æµ®åœ¨ Hero åº•éƒ¨ `-mt-8`ï¼Œç™½è‰² `shadow-xl rounded-2xl` å¡ç‰‡
- é‚®è½®å¡ç‰‡ç½‘æ ¼ `grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8`ï¼Œæ¯å¡ç‰‡å°é¢å›¾ `aspect-[4/3]` + hover æ”¾å¤§ `scale-105 transition-transform duration-500`ï¼Œåº•éƒ¨ç™½è‰²ä¿¡æ¯åŒºå« `Playfair Display` é‚®è½®åã€å‚æ•°å°æ ‡ç­¾è¡Œã€æš–é‡‘"æŸ¥çœ‹è¯¦æƒ…"é“¾æ¥

é‚®è½®è¯¦æƒ…é¡µï¼ˆéµå¾ª Web æ²‰æµ¸å¼æ—…è¡Œæ‚å¿—é£æ ¼ï¼‰ï¼š
- é¡¶éƒ¨å…¨å®½è½®æ’­ `70vh`ï¼ŒSwiper å¸¦åŠé€æ˜ç™½è‰²åœ†å½¢å·¦å³ç®­å¤´ + åº•éƒ¨åœ†ç‚¹æŒ‡ç¤ºå™¨
- åŸºæœ¬å‚æ•°åŒºï¼šå›¾æ ‡+æ•°å­—æ°´å¹³æ’åˆ—ï¼ˆâš“å¨ä½ | ğŸ‘¤è½½å®¢ | ğŸ§­é•¿åº¦ç­‰ï¼‰ï¼Œæš–é‡‘ `#C9A96E` åˆ†éš”ç¬¦ï¼Œæ•°å­—ä½¿ç”¨ CountUp æ»šåŠ¨åŠ¨æ•ˆ
- èˆ±æˆ¿ç±»å‹ Accordion æŠ˜å é¢æ¿ï¼šæ”¶èµ·æ€=ç¼©ç•¥å›¾+åç§°+é¢ç§¯+èµ·å§‹ä»·ï¼ˆæš–é‡‘å¤§å­—ï¼‰ï¼Œå±•å¼€æ€=å¤§å›¾ç”»å»Š + å¯Œæ–‡æœ¬ä»‹ç» + è®¾æ–½ icon ç½‘æ ¼ + åºŠå‹è¯´æ˜
- è®¾æ–½å¯¼è§ˆï¼šèƒ¶å›Šå¼ `rounded-full` åˆ†ç±» Tab æ ï¼Œè®¾æ–½æ¨ªå‘å¡ç‰‡ï¼ˆå·¦å›¾å³æ–‡ï¼‰ï¼Œå…è´¹ `bg-emerald-50 text-emerald-700` / æ”¶è´¹ `bg-amber-50 text-amber-700` æ ‡ç­¾
- è®¾æ–½è¯¦æƒ…å¼¹çª—ï¼š`backdrop-blur` é®ç½© + ç™½è‰²åœ†è§’ modalï¼Œå®Œæ•´å¯Œæ–‡æœ¬å†…å®¹
- å…³è”èˆªçº¿ï¼šæ—¶é—´è½´å¼å¸ƒå±€ï¼Œå‡ºå‘æ—¥æœŸèŠ‚ç‚¹ + èˆªçº¿å + æœ€ä½ä»·æš–é‡‘å¤§å­—

**æäº¤ï¼š** `git commit -m "feat: add web cruise listing and detail pages"`

---

### Task 19: å°ç¨‹åº â€” é‚®è½®åˆ—è¡¨ + è¯¦æƒ…é¡µ

**ç›®æ ‡ï¼š** å®ç° Specify A.4 çš„å°ç¨‹åºç‰ˆé‚®è½®å±•ç¤ºã€‚

**Filesï¼š**
- Create: `frontend/miniapp/pages/cruise/list.vue`
- Create: `frontend/miniapp/pages/cruise/detail.vue`
- å¯¹åº”æµ‹è¯•

**RED â†’ GREEN â†’ REFACTOR**

ä½¿ç”¨å°ç¨‹åºåŸç”Ÿç»„ä»¶ï¼Œéµå¾ª **Miniapp åŸç”Ÿå¾®ä¿¡è®¾è®¡è¯­è¨€** è§„èŒƒï¼š

é‚®è½®åˆ—è¡¨é¡µï¼š
- å›ºå®šé¡¶éƒ¨æœç´¢æ  `position: fixed`ï¼Œç™½è‰²èƒŒæ™¯ + åœ†è§’æœç´¢æ¡† `border-radius: 32rpx; background: #F5F5F5`
- ç«–å‘å¡ç‰‡åˆ—è¡¨ï¼Œæ¯å¼ å¡ç‰‡ `margin: 16rpx 24rpx; border-radius: 16rpx; box-shadow: 0 2rpx 12rpx rgba(0,0,0,0.06)`
- å¡ç‰‡ï¼šå°é¢å›¾ `<image mode="aspectFill" style="height: 320rpx">`ã€åç§° `32rpx bold`ã€ç°è‰²å‚æ•°è¡Œï¼ˆå¨ä½Â·è½½å®¢é‡Â·Nç§èˆ±å‹ï¼‰ã€çŠç‘šæ©˜"æŸ¥çœ‹è¯¦æƒ… >"é“¾æ¥

é‚®è½®è¯¦æƒ…é¡µï¼š
- `<swiper>` è½®æ’­ `480rpx` é«˜åº¦ + åœ†ç‚¹æŒ‡ç¤ºå™¨
- å‚æ•°åŒºï¼š`<scroll-view scroll-x>` æ°´å¹³æ»šåŠ¨å°å¡ç‰‡æ¡ï¼Œæ¯å¡ç‰‡ `140rpx å®½; background: #F8F9FA; border-radius: 12rpx`ï¼Œå«å›¾æ ‡+æ•°å€¼+æ ‡ç­¾
- èˆ±æˆ¿ç±»å‹åˆ—è¡¨ï¼šå·¦ä¾§å°å›¾ `100rpx*100rpx rounded-12rpx`ï¼Œä¸­é—´åç§°+é¢ç§¯+äººæ•°ï¼Œå³ä¾§çŠç‘šæ©˜èµ·å§‹ä»·ï¼Œç‚¹å‡»å±•å¼€å¤§å›¾+æè¿°
- è®¾æ–½å¯¼è§ˆï¼š`<scroll-view scroll-x>` æ¨ªå‘åˆ†ç±»æ ‡ç­¾ï¼Œé€‰ä¸­æ€ `border-bottom: 4rpx solid #FF6B6B`ï¼Œ2åˆ—è®¾æ–½ç½‘æ ¼
- å…³è”èˆªçº¿å¡ç‰‡åˆ—è¡¨ï¼šå‡ºå‘æ—¥æœŸå¾½ç«  `bg-Coral-50`ã€èˆªçº¿åã€æœ€ä½ä»·
- åº•éƒ¨å®‰å…¨åŒºæ“ä½œæ  `padding-bottom: env(safe-area-inset-bottom)`ï¼Œæ”¶è—+åˆ†äº«å›¾æ ‡ + çŠç‘šæ©˜"æŸ¥çœ‹èˆªçº¿"æŒ‰é’® `border-radius: 44rpx; height: 88rpx`

**å…³é”®ï¼š** å±•ç¤ºçš„ä¸šåŠ¡æ•°æ®ï¼ˆé‚®è½®å‚æ•°ã€èˆ±æˆ¿ç±»å‹ã€è®¾æ–½ã€ä»·æ ¼ã€èˆªçº¿ï¼‰å¿…é¡»ä¸ Web å‰å°å®Œå…¨ä¸€è‡´ï¼Œè°ƒç”¨ç›¸åŒçš„ API æ¥å£ã€‚

**æäº¤ï¼š** `git commit -m "feat: add miniapp cruise listing and detail pages"`

---

### Task 20: Web + Miniapp â€” èˆ±ä½æµè§ˆå¢å¼º

**ç›®æ ‡ï¼š** å‰å°èˆ±ä½æµè§ˆé¡µé¢å¢å¼ºï¼Œå¢åŠ è¯¦ç»†å±æ€§å±•ç¤ºå’Œç­›é€‰ã€‚

**Filesï¼š**
- Modify: `frontend/web/app/pages/cabins/[id].vue` â€” ä¸°å¯Œèˆ±ä½è¯¦æƒ…
- Modify: `frontend/miniapp/pages/cabin/detail.vue` â€” ä¸°å¯Œèˆ±ä½è¯¦æƒ…
- å¯¹åº”æµ‹è¯•

**RED â†’ GREEN â†’ REFACTOR**

**Web èˆ±ä½è¯¦æƒ…**ï¼ˆéµå¾ªæ²‰æµ¸å¼æ—…è¡Œæ‚å¿—é£æ ¼ï¼‰ï¼š
- æ¡Œé¢ç«¯åŒæ å¸ƒå±€ï¼ˆå·¦ä¾§å¤§å›¾ç”»å»Šã€å³ä¾§ä¿¡æ¯é¢æ¿ï¼‰
- å±æ€§æ ‡ç­¾äº‘ï¼šèƒ¶å›Šæ ‡ç­¾ `bg-blue-50 text-blue-700 rounded-full`ï¼ˆåºŠå‹/é˜³å°/æµ·æ™¯/çª—æˆ·ç­‰ï¼‰
- ä»·æ ¼æ—¥å†ï¼šç½‘æ ¼å¡ç‰‡ `grid-cols-7`ï¼ˆä½ä»·æ—¥ç»¿è‰²/å¸¸è§„ç°ç™½/é«˜ä»·æ—¥æ©™è‰²/ä¸å¯ç”¨ç°è‰²ç¦ç”¨ï¼‰ï¼Œå¤šä»·æ ¼ç±»å‹ Tab åˆ‡æ¢
- åº“å­˜å¯è§†åŒ–ï¼šè¿›åº¦æ¡ï¼ˆç»¿>50%/æ©™20-50%/çº¢<20%ï¼‰+ æ–‡å­—æ ‡ç­¾
- åº•éƒ¨ sticky CTA æ ï¼šæ·±æµ·è“èƒŒæ™¯ + ç™½è‰²"ç«‹å³é¢„è®¢"å¤§æŒ‰é’® + ä»·æ ¼

**å°ç¨‹åºèˆ±ä½è¯¦æƒ…**ï¼ˆéµå¾ªå¾®ä¿¡åŸç”Ÿè®¾è®¡è¯­è¨€ï¼‰ï¼š
- Swiper å¤§å›¾ + `N/M` é¡µç è§’æ ‡
- çŠç‘šæ©˜ä»·æ ¼è¡Œ `Â¥1,280èµ·` + ç°è‰²"å«ç¨è´¹"
- å±æ€§æ ‡ç­¾æµ `flex-wrap gap-12rpx`ï¼Œæ¯æ ‡ç­¾ `background: #F0F7FF; color: #4A90D9; border-radius: 8rpx; padding: 8rpx 16rpx; font-size: 24rpx`
- è®¾æ–½æ¸…å•ä¸¤åˆ— icon ç½‘æ ¼
- ä»·æ ¼æ—¥å†ï¼šæ°´å¹³æ»‘åŠ¨æ—¥æœŸæ¡ + é€‰ä¸­æ—¥è¯¦ç»†ä»·æ ¼é¢æ¿
- åº“å­˜æ–‡å­—æ ‡ç­¾ï¼ˆ"ä»…å‰©3é—´"çº¢è‰² / "å……è¶³"ç»¿è‰²ï¼‰ï¼Œä¸ç”¨è¿›åº¦æ¡
- åº•éƒ¨æ“ä½œæ ï¼šå®¢æœå›¾æ ‡ + çŠç‘šæ©˜"ç«‹å³é¢„è®¢"åœ†è§’å¤§æŒ‰é’®

**å…³é”®ï¼š** ä¸¤ç«¯å±•ç¤ºçš„å±æ€§æ•°æ®ã€ä»·æ ¼æ•°æ®ã€åº“å­˜æ•°æ®å®Œå…¨ä¸€è‡´ï¼Œè°ƒç”¨ç›¸åŒ APIã€‚

**æäº¤ï¼š** `git commit -m "feat: enhance cabin detail pages with extended attributes"`

---

## Part E: å…±äº«ç±»å‹ + Swagger (Tasks 21-22)

### Task 21: å‰ç«¯å…±äº«ç±»å‹æ›´æ–°

**Filesï¼š**
- Modify: `frontend/shared/types/index.ts`

æ–°å¢/æ›´æ–°ç±»å‹å®šä¹‰ï¼š

```ts
export interface Cruise {
  id: number; company_id: number; name: string; english_name: string;
  code: string; crew_count: number; build_year: number; refurbish_year: number;
  tonnage: number; passenger_capacity: number; room_count: number;
  length: number; width: number; deck_count: number;
  description: string; status: number; sort_order: number;
  created_at: string; updated_at: string;
}

export interface CabinType {
  id: number; cruise_id: number; name: string; english_name: string;
  code: string; area_min: number; area_max: number; area: number;
  capacity: number; max_capacity: number; bed_type: string;
  tags: string; amenities: string; floor_plan_url: string;
  deck: string; description: string; status: number; sort_order: number;
}

export interface Facility {
  id: number; category_id: number; cruise_id: number;
  name: string; english_name: string; location: string;
  open_hours: string; extra_charge: boolean; charge_price_tip: string;
  target_audience: string; description: string;
  status: number; sort_order: number;
}

export interface CabinSKU {
  id: number; voyage_id: number; cabin_type_id: number;
  code: string; deck: string; area: number; max_guests: number;
  position: string; orientation: string;
  has_window: boolean; has_balcony: boolean;
  bed_type: string; amenities: string; status: number;
}

export interface CabinPrice {
  id: number; cabin_sku_id: number; date: string;
  occupancy: number; price_cents: number; price_type: string;
}

export interface CabinInventory {
  id: number; cabin_sku_id: number;
  total: number; locked: number; sold: number; alert_threshold: number;
}

export interface AppImage {
  id: number; entity_type: string; entity_id: number;
  url: string; sort_order: number; is_primary: boolean;
}
```

**æäº¤ï¼š** `git commit -m "feat: update shared types for sprint 4.1"`

---

### Task 22: Swagger æ³¨è§£æ›´æ–°

**ç›®æ ‡ï¼š** ä¸ºæ‰€æœ‰æ–°å¢/ä¿®æ”¹çš„ Handler æ–¹æ³•æ·»åŠ  Swagger æ³¨è§£ã€‚

**Filesï¼š**
- Modify: æ‰€æœ‰ä¿®æ”¹è¿‡çš„ `backend/internal/handler/*.go` æ–‡ä»¶

ä¸ºæ–°å¢ç«¯ç‚¹ï¼ˆBatchUpdateStatus, FilteredList, image CRUD, cabin alerts ç­‰ï¼‰æ·»åŠ å®Œæ•´ Swagger æ³¨è§£ã€‚

è¿è¡Œ `cd backend && make swagger` éªŒè¯æ–‡æ¡£ç”Ÿæˆã€‚

**æäº¤ï¼š** `git commit -m "docs: update swagger annotations for sprint 4.1 endpoints"`

---

## Part F: å…¨é‡æµ‹è¯•éªŒè¯ (Task 23)

### Task 23: å…¨é‡æµ‹è¯• + è¦†ç›–ç‡éªŒè¯

**æ­¥éª¤ï¼š**

1. åç«¯å…¨é‡æµ‹è¯•ï¼š
```bash
cd backend && go test ./... -coverprofile=coverage -count=1 -v
```
ç¡®è®¤ **100% è¦†ç›–ç‡**ã€‚

2. Admin å‰ç«¯æµ‹è¯•ï¼š
```bash
cd frontend/admin && pnpm vitest run --coverage
```
ç¡®è®¤ **100% è¦†ç›–ç‡**ã€‚

3. Web å‰ç«¯æµ‹è¯•ï¼š
```bash
cd frontend/web && pnpm vitest run --coverage
```
ç¡®è®¤ **100% è¦†ç›–ç‡**ã€‚

4. å°ç¨‹åºå‰ç«¯æµ‹è¯•ï¼š
```bash
cd frontend/miniapp && pnpm vitest run --coverage
```
ç¡®è®¤ **100% è¦†ç›–ç‡**ã€‚

5. å¦‚æœ‰è¦†ç›–ç‡ä¸è¶³ï¼Œè¡¥å……ç¼ºå¤±çš„æµ‹è¯•ç”¨ä¾‹åé‡æ–°éªŒè¯ã€‚

**æœ€ç»ˆæäº¤ï¼š** `git commit -m "test: sprint 4.1 all tests passing at 100% coverage"`

---

## å˜æ›´æ–‡ä»¶æ±‡æ€»

| å±‚çº§ | ä¿®æ”¹æ–‡ä»¶ | æ–°å»ºæ–‡ä»¶ |
|------|---------|---------|
| Domain | `cruise.go`, `cabin_type.go`, `facility.go`, `facility_category.go`, `cabin.go`, `image.go`, `repository.go` | `cabin_type_test.go`, `facility_test.go`, `cabin_extended_test.go` |
| Migration | â€” | `000005_sprint41_extend.up/down.sql`, `migrations_sprint41_test.go` |
| Repository | `cruise_repo.go`, `cabin_type_repo.go`, `facility_repo.go`, `facility_category_repo.go`, `cabin_repo.go` | `image_repo.go`, `image_repo_test.go` |
| Service | `cruise_service.go`, `cabin_type_service.go`, `facility_service.go`, `facility_category_service.go`, `cabin_admin_service.go` | `image_service.go`, `inventory_alert_service.go` åŠæµ‹è¯• |
| Handler | `cruise_handler.go`, `cabin_handler.go`, `cabin_type_handler.go`, `facility_handler.go`, `facility_category_handler.go` | `image_handler.go` åŠæµ‹è¯• |
| Router | `router.go` | â€” |
| Shared Types | `types/index.ts` | â€” |
| Admin Pages | `cruises/*`, `cabins/*` | `cabin-types/*`, `facility-categories/*`, `facilities/*`, `cabins/alerts.vue` |
| Web Pages | `cabins/[id].vue` | `cruises/index.vue`, `cruises/[id].vue` |
| Miniapp Pages | `cabin/detail.vue` | `cruise/list.vue`, `cruise/detail.vue` |
